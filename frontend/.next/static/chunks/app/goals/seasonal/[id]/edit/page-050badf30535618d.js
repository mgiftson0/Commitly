(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1541],{9633:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var a=s(95155),l=s(12115),r=s(97003),i=s(33789),n=s(90235),d=s(67001),c=s(83209),o=s(47507),u=s(67812),x=s(30814),m=s(35626),h=s(52056),p=s(6191),v=s(65229),f=s(99708),g=s(91169),j=s(39068),b=s(52619),N=s.n(b),y=s(20063),w=s(18720),_=s(19885),k=s(42855);function A(){let[e,t]=(0,l.useState)(null),[s,b]=(0,l.useState)(""),[A,z]=(0,l.useState)(""),[C,E]=(0,l.useState)(""),[M,D]=(0,l.useState)([""]),[G,S]=(0,l.useState)(!1),[q,R]=(0,l.useState)("public"),[T,L]=(0,l.useState)(!1),[P,Z]=(0,l.useState)(""),B=(0,y.useRouter)(),F=(0,y.useParams)().id;(0,l.useEffect)(()=>{let e=async()=>{try{var e;let s=await k._.getCurrentUser();if(!s)return void B.push("/auth/login");let{data:a,error:l}=await k.N.from("goals").select("*").eq("id",F).eq("user_id",s.id).single();if(l||!a){w.oR.error("Goal not found"),B.push("/goals");return}let r=((e,t)=>{if("completed"===t)return!1;let s=new Date(e).getTime(),a=Date.now()-s;if(a<=18e6){let e=18e6-a,t=Math.floor(e/36e5),s=Math.floor(e%36e5/6e4);return Z("".concat(t,"h ").concat(s,"m")),!0}return!1})(a.created_at,a.status);L(r),t(a),b(a.title),z(a.description||""),E((null==(e=a.category)?void 0:e.replace("_","-"))||""),R(a.visibility);let{data:i}=await k.N.from("goal_activities").select("*").eq("goal_id",F).order("order_index");i&&i.length>0&&D(i.map(e=>e.title))}catch(e){console.error("Error loading goal:",e),w.oR.error("Failed to load goal"),B.push("/goals")}};F&&e()},[F,B]);let O=async e=>{if(e.preventDefault(),!T)return void w.oR.error("Goal can no longer be edited");S(!0);try{let{error:e}=await k.N.from("goals").update({title:s,description:A,category:C.replace("-","_"),visibility:q,target_date:null}).eq("id",F);if(e)throw e;if(await k.N.from("goal_activities").delete().eq("goal_id",F),M.filter(e=>e.trim()).length>0){let e=M.filter(e=>e.trim()).map((e,t)=>({goal_id:F,title:e.trim(),completed:!1,order_index:t}));await k.N.from("goal_activities").insert(e)}w.oR.success("Goal updated successfully!"),window.dispatchEvent(new CustomEvent("goalUpdated",{detail:{goalId:F}})),B.push("/goals")}catch(e){w.oR.error(e.message||"Failed to update goal")}finally{S(!1)}};return e?(0,a.jsx)(_.O,{children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Edit Seasonal Goal"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:T?"Edit within ".concat(P," remaining"):"Goal can only be edited within 5 hours of creation"})]}),(0,a.jsxs)(r.$,{variant:"outline",onClick:()=>B.push("/goals"),children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Back to Goals"]})]}),!T&&(0,a.jsx)(c.Zp,{className:"border-amber-200 bg-amber-50",children:(0,a.jsxs)(c.Wu,{className:"p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 text-amber-600"}),(0,a.jsx)("span",{className:"font-medium text-amber-900",children:"Editing Disabled"})]}),(0,a.jsx)("p",{className:"text-sm text-amber-700",children:"completed"===e.status?"This goal is completed and cannot be edited.":"Goals can only be edited within 5 hours of creation. Use the Update page to track progress."})]})}),(0,a.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)("form",{onSubmit:O,children:(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsx)(c.ZB,{children:"Goal Details"}),(0,a.jsx)(c.BT,{children:"Edit your seasonal goal details"})]}),(0,a.jsxs)(c.Wu,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(n.J,{htmlFor:"title",children:["Goal Title ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(i.p,{id:"title",value:s,onChange:e=>b(e.target.value),disabled:!T,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(n.J,{htmlFor:"description",children:["Description ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(d.T,{id:"description",value:A,onChange:e=>z(e.target.value),rows:3,disabled:!T,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(n.J,{children:["Category ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)(o.l6,{value:C,onValueChange:E,disabled:!T,children:[(0,a.jsx)(o.bq,{children:(0,a.jsx)(o.yv,{})}),(0,a.jsxs)(o.gC,{children:[(0,a.jsx)(o.eb,{value:"health-fitness",children:"Health & Fitness"}),(0,a.jsx)(o.eb,{value:"learning",children:"Learning & Education"}),(0,a.jsx)(o.eb,{value:"career",children:"Career & Business"}),(0,a.jsx)(o.eb,{value:"creative",children:"Creative Arts"}),(0,a.jsx)(o.eb,{value:"personal",children:"Personal Growth"}),(0,a.jsx)(o.eb,{value:"relationships",children:"Relationships"}),(0,a.jsx)(o.eb,{value:"finance",children:"Finance"})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(n.J,{children:["Key Milestones ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),T&&(0,a.jsxs)(r.$,{type:"button",variant:"outline",size:"sm",onClick:()=>{D([...M,""])},children:[(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Add Milestone"]})]}),(0,a.jsx)("div",{className:"space-y-3",children:M.map((e,t)=>(0,a.jsx)("div",{className:"space-y-2 p-3 rounded-lg border bg-card",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(i.p,{placeholder:"Milestone ".concat(t+1),value:e,onChange:e=>((e,t)=>{let s=[...M];s[e]=t,D(s)})(t,e.target.value),disabled:!T,required:!0}),T&&M.length>1&&(0,a.jsx)(r.$,{type:"button",variant:"outline",size:"icon",onClick:()=>(e=>{D(M.filter((t,s)=>s!==e));let t={...milestonesDates};delete t[e],setMilestonesDates(t)})(t),children:(0,a.jsx)(v.A,{className:"h-4 w-4"})})]})},t))})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(n.J,{children:["Visibility ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)(o.l6,{value:q,onValueChange:R,disabled:!T,children:[(0,a.jsx)(o.bq,{children:(0,a.jsx)(o.yv,{})}),(0,a.jsxs)(o.gC,{children:[(0,a.jsx)(o.eb,{value:"private",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Private"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Only you can see"})]})]})}),(0,a.jsx)(o.eb,{value:"restricted",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"h-4 w-4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Partners Only"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Only your partners can see"})]})]})}),(0,a.jsx)(o.eb,{value:"public",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.A,{className:"h-4 w-4"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium",children:"Public"}),(0,a.jsx)("div",{className:"text-xs text-muted-foreground",children:"Everyone can see"})]})]})})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)(N(),{href:"/goals",className:"flex-1",children:(0,a.jsx)(r.$,{type:"button",variant:"outline",className:"w-full",children:"Cancel"})}),(0,a.jsx)(r.$,{type:"submit",className:"flex-1",disabled:!T||G||!s.trim()||!A.trim()||!C||0===M.filter(e=>e.trim()).length,children:G?"Updating...":"Update Goal"})]})]})]})})}),(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsx)(c.ZB,{children:"Goal Info"})}),(0,a.jsxs)(c.Wu,{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Type:"}),(0,a.jsx)(u.E,{variant:"outline",children:"Seasonal"})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Duration:"}),(0,a.jsx)("span",{className:"capitalize",children:e.duration_type})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Status:"}),(0,a.jsx)(u.E,{variant:"completed"===e.status?"default":"secondary",children:e.status})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:"Created:"}),(0,a.jsx)("span",{children:new Date(e.created_at).toLocaleDateString()})]})]})]})})]})]})}):(0,a.jsx)(_.O,{children:(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(x.A,{className:"h-12 w-12 text-primary animate-pulse mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading goal..."})]})})})}},10489:(e,t,s)=>{"use strict";s.d(t,{b:()=>n});var a=s(12115),l=s(97602),r=s(95155),i=a.forwardRef((e,t)=>(0,r.jsx)(l.sG.label,{...e,ref:t,onMouseDown:t=>{var s;t.target.closest("button, input, select, textarea")||(null==(s=e.onMouseDown)||s.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));i.displayName="Label";var n=i},35626:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},37995:(e,t,s)=>{Promise.resolve().then(s.bind(s,9633))},39068:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},47507:(e,t,s)=>{"use strict";s.d(t,{bq:()=>u,eb:()=>m,gC:()=>x,l6:()=>c,yv:()=>o});var a=s(95155);s(12115);var l=s(98229),r=s(24033),i=s(5917),n=s(12108),d=s(25016);function c(e){let{...t}=e;return(0,a.jsx)(l.bL,{"data-slot":"select",...t})}function o(e){let{...t}=e;return(0,a.jsx)(l.WT,{"data-slot":"select-value",...t})}function u(e){let{className:t,size:s="default",children:i,...n}=e;return(0,a.jsxs)(l.l9,{"data-slot":"select-trigger","data-size":s,className:(0,d.cn)("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...n,children:[i,(0,a.jsx)(l.In,{asChild:!0,children:(0,a.jsx)(r.A,{className:"size-4 opacity-50"})})]})}function x(e){let{className:t,children:s,position:r="popper",...i}=e;return(0,a.jsx)(l.ZL,{children:(0,a.jsxs)(l.UC,{"data-slot":"select-content",className:(0,d.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...i,children:[(0,a.jsx)(h,{}),(0,a.jsx)(l.LM,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),(0,a.jsx)(p,{})]})})}function m(e){let{className:t,children:s,...r}=e;return(0,a.jsxs)(l.q7,{"data-slot":"select-item",className:(0,d.cn)("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",t),...r,children:[(0,a.jsx)("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:(0,a.jsx)(l.VF,{children:(0,a.jsx)(i.A,{className:"size-4"})})}),(0,a.jsx)(l.p4,{children:s})]})}function h(e){let{className:t,...s}=e;return(0,a.jsx)(l.PP,{"data-slot":"select-scroll-up-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(n.A,{className:"size-4"})})}function p(e){let{className:t,...s}=e;return(0,a.jsx)(l.wn,{"data-slot":"select-scroll-down-button",className:(0,d.cn)("flex cursor-default items-center justify-center py-1",t),...s,children:(0,a.jsx)(r.A,{className:"size-4"})})}},52056:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},67001:(e,t,s)=>{"use strict";s.d(t,{T:()=>r});var a=s(95155);s(12115);var l=s(25016);function r(e){let{className:t,...s}=e;return(0,a.jsx)("textarea",{"data-slot":"textarea",className:(0,l.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...s})}},83209:(e,t,s)=>{"use strict";s.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>n,Zp:()=>r,aR:()=>i});var a=s(95155);s(12115);var l=s(25016);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card",className:(0,l.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...s})}function i(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-header",className:(0,l.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...s})}function n(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-title",className:(0,l.cn)("leading-none font-semibold",t),...s})}function d(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-description",className:(0,l.cn)("text-muted-foreground text-sm",t),...s})}function c(e){let{className:t,...s}=e;return(0,a.jsx)("div",{"data-slot":"card-content",className:(0,l.cn)("px-6",t),...s})}},90235:(e,t,s)=>{"use strict";s.d(t,{J:()=>i});var a=s(95155);s(12115);var l=s(10489),r=s(25016);function i(e){let{className:t,...s}=e;return(0,a.jsx)(l.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...s})}},99708:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{e.O(0,[297,5707,8760,1370,3224,6227,8720,7928,9885,8441,1255,7358],()=>e(e.s=37995)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9062],{10489:(e,t,a)=>{"use strict";a.d(t,{b:()=>d});var s=a(12115),r=a(97602),i=a(95155),l=s.forwardRef((e,t)=>(0,i.jsx)(r.sG.label,{...e,ref:t,onMouseDown:t=>{var a;t.target.closest("button, input, select, textarea")||(null==(a=e.onMouseDown)||a.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));l.displayName="Label";var d=l},35626:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},46046:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},67001:(e,t,a)=>{"use strict";a.d(t,{T:()=>i});var s=a(95155);a(12115);var r=a(25016);function i(e){let{className:t,...a}=e;return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...a})}},78302:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(95155),r=a(12115),i=a(20063),l=a(97003),d=a(83209),n=a(33789),o=a(90235),c=a(67001),u=a(35626),x=a(26983),g=a(6191),h=a(65229),m=a(46046),p=a(19885),v=a(42855),f=a(18720);function b(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),a=e.id,[b,j]=(0,r.useState)(null),[w,N]=(0,r.useState)([]),[y,_]=(0,r.useState)(!0),[k,D]=(0,r.useState)(!1),[S,C]=(0,r.useState)(!1),[A,R]=(0,r.useState)(""),[T,E]=(0,r.useState)(""),[G,M]=(0,r.useState)(""),[O,Z]=(0,r.useState)("");(0,r.useEffect)(()=>{F()},[F]);let F=(0,r.useCallback)(async()=>{try{if(!await v._.getCurrentUser())return void t.push("/auth/login");let{data:e,error:s}=await v.N.from("goals").select("*").eq("id",a).maybeSingle();if(s||!e){f.oR.error("Goal not found"),t.push("/goals");return}let r=new Date().toISOString().split("T")[0],i=e.start_date?e.start_date.split("T")[0]:null,l="pending"===e.status||i&&i>r,d=!1;if(l&&i){let e=new Date(i).getTime();d=Date.now()<=e-18e6}else{let t=new Date(e.created_at).getTime();d=Date.now()-t<=18e6}if(!d){f.oR.error("Goal can no longer be edited"),t.push("/goals/".concat(a,"/update"));return}if(C(!0),j(e),R(e.title||""),E(e.description||""),M(e.start_date?e.start_date.split("T")[0]:""),Z(e.target_date?e.target_date.split("T")[0]:""),"multi-activity"===e.goal_type){let{data:e}=await v.N.from("goal_activities").select("*").eq("goal_id",a).order("order_index");N(e||[])}_(!1)}catch(e){console.error("Error loading goal:",e),f.oR.error("Failed to load goal"),t.push("/goals")}},[a,t]),$=async()=>{if(!A.trim())return void f.oR.error("Goal title is required");if("multi-activity"===b.goal_type&&w.some(e=>!e.title.trim()))return void f.oR.error("All activities must have a title");if(G&&O&&new Date(G)>=new Date(O))return void f.oR.error("Start date must be before target date");if(G){let e=new Date;if(e.setMonth(e.getMonth()+2),new Date(G)>e)return void f.oR.error("Start date cannot be more than 2 months in the future")}D(!0);try{let{error:e}=await v.N.from("goals").update({title:A.trim(),description:T.trim(),start_date:G||null,target_date:O||null,updated_at:new Date().toISOString()}).eq("id",a);if(e)throw e;if("multi-activity"===b.goal_type&&(await v.N.from("goal_activities").delete().eq("goal_id",a),w.length>0)){let e=w.map((e,t)=>({goal_id:a,title:e.title.trim(),order_index:t,completed:!1})),{error:t}=await v.N.from("goal_activities").insert(e);if(t)throw t}f.oR.success("Goal updated successfully"),t.push("/goals/".concat(a))}catch(e){console.error("Error saving goal:",e),f.oR.error("Failed to save goal")}finally{D(!1)}};return y?(0,s.jsx)(p.O,{children:(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"animate-pulse",children:"Loading..."})})}):S?(0,s.jsx)(p.O,{children:(0,s.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Edit Goal"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"pending"===b.status?"Edit activities and dates for pending goal":"Edit goal details and activities"})]}),(0,s.jsxs)(l.$,{variant:"outline",onClick:()=>t.push("/goals"),children:[(0,s.jsx)(u.A,{className:"h-4 w-4 mr-2"}),"Back to Goals"]})]}),"pending"===b.status&&(0,s.jsx)(d.Zp,{className:"border-blue-200 bg-blue-50 shadow-[0_16px_38px_rgba(15,23,42,0.12)]",children:(0,s.jsxs)(d.Wu,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(x.A,{className:"h-4 w-4 text-blue-600"}),(0,s.jsx)("span",{className:"font-medium text-blue-900",children:"Pending Goal"})]}),(0,s.jsxs)("p",{className:"text-sm text-blue-700",children:["This goal will become active on ",G?new Date(G).toLocaleDateString():"the start date","."]})]})}),(0,s.jsxs)(d.Zp,{className:"border-slate-200 bg-white shadow-[0_18px_40px_rgba(15,23,42,0.14)] dark:border-slate-800 dark:bg-slate-900",children:[(0,s.jsx)(d.aR,{children:(0,s.jsx)(d.ZB,{children:"Goal Details"})}),(0,s.jsxs)(d.Wu,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.J,{htmlFor:"title",children:"Title"}),(0,s.jsx)(n.p,{id:"title",value:A,onChange:e=>R(e.target.value),placeholder:"Enter goal title"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.J,{htmlFor:"description",children:"Description"}),(0,s.jsx)(c.T,{id:"description",value:T,onChange:e=>E(e.target.value),placeholder:"Enter goal description (optional)",rows:3})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.J,{htmlFor:"startDate",children:"Start Date"}),(0,s.jsx)(n.p,{id:"startDate",type:"date",value:G,onChange:e=>M(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.J,{htmlFor:"targetDate",children:"Target Date"}),(0,s.jsx)(n.p,{id:"targetDate",type:"date",value:O,onChange:e=>Z(e.target.value)})]})]})]})]}),"multi-activity"===b.goal_type&&(0,s.jsxs)(d.Zp,{className:"border-slate-200 bg-white shadow-[0_18px_40px_rgba(15,23,42,0.14)] dark:border-slate-800 dark:bg-slate-900",children:[(0,s.jsx)(d.aR,{children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(d.ZB,{children:"Activities"}),(0,s.jsxs)(l.$,{onClick:()=>{N([...w,{title:"",order_index:w.length}])},size:"sm",variant:"outline",children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Add Activity"]})]})}),(0,s.jsxs)(d.Wu,{className:"space-y-3",children:[w.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.p,{value:e.title,onChange:e=>{var a;return a=e.target.value,void N(w.map((e,s)=>s===t?{...e,title:a}:e))},placeholder:"Activity ".concat(t+1)}),(0,s.jsx)(l.$,{onClick:()=>{N(w.filter((e,a)=>a!==t))},size:"sm",variant:"outline",disabled:w.length<=1,children:(0,s.jsx)(h.A,{className:"h-4 w-4"})})]},t)),0===w.length&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No activities added yet. Click “Add Activity” to get started."})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.$,{onClick:$,disabled:k,children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),k?"Saving...":"Save Changes"]}),(0,s.jsx)(l.$,{variant:"outline",onClick:()=>t.push("/goals/".concat(a)),children:"Cancel"})]})]})}):(0,s.jsx)(p.O,{children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("p",{className:"text-muted-foreground mb-4",children:"Goal can no longer be edited"}),(0,s.jsx)(l.$,{onClick:()=>t.push("/goals/".concat(a,"/update")),children:"Go to Update Page"})]})})}},83209:(e,t,a)=>{"use strict";a.d(t,{BT:()=>n,Wu:()=>o,ZB:()=>d,Zp:()=>i,aR:()=>l});var s=a(95155);a(12115);var r=a(25016);function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...a})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...a})}},90235:(e,t,a)=>{"use strict";a.d(t,{J:()=>l});var s=a(95155);a(12115);var r=a(10489),i=a(25016);function l(e){let{className:t,...a}=e;return(0,s.jsx)(r.b,{"data-slot":"label",className:(0,i.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",t),...a})}},90905:(e,t,a)=>{Promise.resolve().then(a.bind(a,78302))}},e=>{e.O(0,[297,5707,8760,1370,3224,6227,8720,9885,8441,1255,7358],()=>e(e.s=90905)),_N_E=e.O()}]);
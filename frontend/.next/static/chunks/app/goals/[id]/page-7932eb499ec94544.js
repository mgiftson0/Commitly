(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9761],{911:(e,t,a)=>{Promise.resolve().then(a.bind(a,62293))},5917:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},8198:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]])},11010:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},16485:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},35626:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},37772:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},38162:(e,t,a)=>{"use strict";a.d(t,{C1:()=>b,bL:()=>N});var s=a(12115),r=a(94446),i=a(3468),l=a(92556),n=a(23558),d=a(78108),c=a(84288),o=a(76842),u=a(97602),m=a(95155),x="Checkbox",[h,p]=(0,i.A)(x),[g,f]=h(x);function v(e){let{__scopeCheckbox:t,checked:a,children:r,defaultChecked:i,disabled:l,form:d,name:c,onCheckedChange:o,required:u,value:h="on",internal_do_not_use_render:p}=e,[f,v]=(0,n.i)({prop:a,defaultProp:null!=i&&i,onChange:o,caller:x}),[j,y]=s.useState(null),[N,k]=s.useState(null),b=s.useRef(!1),w=!j||!!d||!!j.closest("form"),_={checked:f,disabled:l,setChecked:v,control:j,setControl:y,name:c,form:d,value:h,hasConsumerStoppedPropagationRef:b,required:u,defaultChecked:!A(i)&&i,isFormControl:w,bubbleInput:N,setBubbleInput:k};return(0,m.jsx)(g,{scope:t,..._,children:"function"==typeof p?p(_):r})}var j="CheckboxTrigger",y=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,onKeyDown:i,onClick:n,...d}=e,{control:c,value:o,disabled:x,checked:h,required:p,setControl:g,setChecked:v,hasConsumerStoppedPropagationRef:y,isFormControl:N,bubbleInput:k}=f(j,a),b=(0,r.s)(t,g),w=s.useRef(h);return s.useEffect(()=>{let e=null==c?void 0:c.form;if(e){let t=()=>v(w.current);return e.addEventListener("reset",t),()=>e.removeEventListener("reset",t)}},[c,v]),(0,m.jsx)(u.sG.button,{type:"button",role:"checkbox","aria-checked":A(h)?"mixed":h,"aria-required":p,"data-state":C(h),"data-disabled":x?"":void 0,disabled:x,value:o,...d,ref:b,onKeyDown:(0,l.mK)(i,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,l.mK)(n,e=>{v(e=>!!A(e)||!e),k&&N&&(y.current=e.isPropagationStopped(),y.current||e.stopPropagation())})})});y.displayName=j;var N=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:s,checked:r,defaultChecked:i,required:l,disabled:n,value:d,onCheckedChange:c,form:o,...u}=e;return(0,m.jsx)(v,{__scopeCheckbox:a,checked:r,defaultChecked:i,disabled:n,required:l,onCheckedChange:c,name:s,form:o,value:d,internal_do_not_use_render:e=>{let{isFormControl:s}=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y,{...u,ref:t,__scopeCheckbox:a}),s&&(0,m.jsx)(_,{__scopeCheckbox:a})]})}})});N.displayName=x;var k="CheckboxIndicator",b=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:s,...r}=e,i=f(k,a);return(0,m.jsx)(o.C,{present:s||A(i.checked)||!0===i.checked,children:(0,m.jsx)(u.sG.span,{"data-state":C(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:t,style:{pointerEvents:"none",...e.style}})})});b.displayName=k;var w="CheckboxBubbleInput",_=s.forwardRef((e,t)=>{let{__scopeCheckbox:a,...i}=e,{control:l,hasConsumerStoppedPropagationRef:n,checked:o,defaultChecked:x,required:h,disabled:p,name:g,value:v,form:j,bubbleInput:y,setBubbleInput:N}=f(w,a),k=(0,r.s)(t,N),b=(0,d.Z)(o),_=(0,c.X)(l);s.useEffect(()=>{if(!y)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,t=!n.current;if(b!==o&&e){let a=new Event("click",{bubbles:t});y.indeterminate=A(o),e.call(y,!A(o)&&o),y.dispatchEvent(a)}},[y,b,o,n]);let C=s.useRef(!A(o)&&o);return(0,m.jsx)(u.sG.input,{type:"checkbox","aria-hidden":!0,defaultChecked:null!=x?x:C.current,required:h,disabled:p,name:g,value:v,form:j,...i,tabIndex:-1,ref:k,style:{...i.style,..._,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function A(e){return"indeterminate"===e}function C(e){return A(e)?"indeterminate":e?"checked":"unchecked"}_.displayName=w},61362:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},62293:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_});var s=a(95155),r=a(12115),i=a(20063),l=a(97003),n=a(83209),d=a(67812),c=a(55850),o=a(84916),u=a(30814),m=a(35626),x=a(37772),h=a(11010),p=a(61362),g=a(71360),f=a(16485),v=a(20508),j=a(26983),y=a(8198),N=a(19885),k=a(42855),b=a(18720),w=a(7220);function _(){var e;let t=(0,i.useParams)(),_=(0,i.useRouter)(),A=t.id,[C,S]=(0,r.useState)(null),[E,R]=(0,r.useState)([]),[D,M]=(0,r.useState)(!0),[G,z]=(0,r.useState)(null),[q,L]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=async()=>{try{let e=await k._.getCurrentUser();if(!e)return void _.push("/auth/login");if(z(e),!A||"undefined"===A||"null"===A||"NaN"===A){console.error("Invalid goal ID:",A),b.oR.error("Invalid goal ID"),_.push("/goals");return}let{data:t,error:a}=await k.N.from("goals").select("*").eq("id",A).maybeSingle();if(a||!t){b.oR.error("Goal not found"),_.push("/goals");return}if(S(t),L(t.user_id===e.id),"multi-activity"===t.goal_type){let{data:e}=await k.N.from("goal_activities").select("*").eq("goal_id",A).order("order_index");R(e||[])}}catch(e){console.error("Error loading goal:",e),b.oR.error("Failed to load goal")}finally{M(!1)}};A&&e()},[A,_]);let I=async(e,t)=>{try{let{error:a}=await k.N.from("goal_activities").update({completed:t}).eq("id",e);if(a)throw a;R(a=>a.map(a=>a.id===e?{...a,completed:t}:a));let s=E.filter(a=>a.id===e?t:a.completed).length,r=Math.round(s/E.length*100);await k.N.from("goals").update({progress:r}).eq("id",A),S(e=>e?{...e,progress:r}:null),b.oR.success(t?"Activity completed!":"Activity unchecked")}catch(e){b.oR.error(e.message||"Failed to update activity")}},O=async()=>{try{let{error:e}=await k.N.from("goals").update({status:"completed",progress:100,completed_at:new Date().toISOString()}).eq("id",A);if(e)throw e;if(S(e=>e?{...e,status:"completed",progress:100}:null),G){let{checkAndUnlockAchievements:e}=await Promise.resolve().then(a.bind(a,97643));await e(G.id,"goal_completed")}b.oR.success("Goal completed! \uD83C\uDF89")}catch(e){b.oR.error(e.message||"Failed to complete goal")}},B=async()=>{if(confirm("Are you sure you want to delete this goal?"))try{let{error:e}=await k.N.from("goals").delete().eq("id",A);if(e)throw e;b.oR.success("Goal deleted"),_.push("/goals")}catch(e){b.oR.error(e.message||"Failed to delete goal")}};return D?(0,s.jsx)(N.O,{children:(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(u.A,{className:"h-12 w-12 text-primary animate-pulse"})})}):C?(0,s.jsx)(N.O,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(l.$,{variant:"outline",onClick:()=>_.push("/goals"),children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Back to Goals"]}),q&&(0,s.jsxs)(w.rI,{children:[(0,s.jsx)(w.ty,{asChild:!0,children:(0,s.jsx)(l.$,{variant:"outline",size:"icon",children:(0,s.jsx)(x.A,{className:"h-4 w-4"})})}),(0,s.jsxs)(w.SQ,{align:"end",children:[(0,s.jsxs)(w._2,{onClick:()=>_.push("/goals/".concat(A,"/edit")),children:[(0,s.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"Edit Goal"]}),"completed"!==C.status&&"pending"!==C.status&&(0,s.jsxs)(w._2,{onClick:O,children:[(0,s.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"Mark Complete"]}),(0,s.jsxs)(w._2,{onClick:B,className:"text-destructive",children:[(0,s.jsx)(g.A,{className:"h-4 w-4 mr-2"}),"Delete Goal"]})]})]})]}),(0,s.jsxs)(n.Zp,{className:"border-slate-200 bg-white shadow-[0_20px_45px_rgba(15,23,42,0.16)] dark:border-slate-800 dark:bg-slate-900",children:[(0,s.jsx)(n.aR,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.ZB,{className:"text-2xl",children:C.title}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(d.E,{variant:"completed"===C.status?"default":"secondary",children:C.status}),(0,s.jsx)(d.E,{variant:"outline",className:"capitalize",children:null==(e=C.category)?void 0:e.replace("_"," ")}),(0,s.jsx)(d.E,{variant:"outline",children:"multi-activity"===C.goal_type?"Multi-Activity":"Single Activity"})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("div",{className:"text-3xl font-bold text-primary",children:[C.progress,"%"]}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:"Complete"})]})]})}),(0,s.jsxs)(n.Wu,{className:"space-y-6",children:[(0,s.jsx)("p",{className:"text-muted-foreground",children:C.description}),(0,s.jsx)(c.k,{value:C.progress,className:"h-3"}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Target Date"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:C.target_date?new Date(C.target_date).toLocaleDateString():"No deadline"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Visibility"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground capitalize",children:C.visibility})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Created"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:new Date(C.created_at).toLocaleDateString()})]})]}),C.duration_type&&"standard"!==C.duration_type&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Duration Type"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground capitalize",children:["annual"===C.duration_type&&"Annual Goal","quarterly"===C.duration_type&&"Quarterly Goal","biannual"===C.duration_type&&"Bi-Annual Goal"]})]})]}),C.seasonal_year&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(f.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Year"}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:C.seasonal_year})]})]}),C.seasonal_quarter&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Quarter"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Q",C.seasonal_quarter," (",(e=>{let t=new Date().getFullYear(),a={1:{start:"".concat(t,"-01-01"),end:"".concat(t,"-03-31")},2:{start:"".concat(t,"-04-01"),end:"".concat(t,"-06-30")},3:{start:"".concat(t,"-07-01"),end:"".concat(t,"-09-30")},4:{start:"".concat(t,"-10-01"),end:"".concat(t,"-12-31")}}[e];if(!a)return"";let s=new Date(a.start).toLocaleDateString("en-US",{month:"short",day:"numeric"}),r=new Date(a.end).toLocaleDateString("en-US",{month:"short",day:"numeric"});return"".concat(s," - ").concat(r)})(C.seasonal_quarter),")"]})]})]})]}),C.schedule_type&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"Schedule"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground capitalize",children:["recurring"===C.schedule_type?"Recurring":"One-time","recurring"===C.schedule_type&&C.recurrence_pattern&&(0,s.jsxs)("span",{className:"ml-1",children:["(",C.recurrence_pattern,")"]})]})]})]}),"recurring"===C.schedule_type&&C.end_condition&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-sm font-medium",children:"End Condition"}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground capitalize",children:["by-date"===C.end_condition&&C.target_date&&"Ends ".concat(new Date(C.target_date).toLocaleDateString()),"after-completions"===C.end_condition&&C.target_completions&&"After ".concat(C.target_completions," completions"),"ongoing"===C.end_condition&&"Ongoing (no end date)"]})]})]})]})]})]}),"multi-activity"===C.goal_type&&E.length>0&&(0,s.jsxs)(n.Zp,{className:"border-slate-200 bg-white shadow-[0_20px_45px_rgba(15,23,42,0.16)] dark:border-slate-800 dark:bg-slate-900",children:[(0,s.jsx)(n.aR,{children:(0,s.jsx)(n.ZB,{children:"Activities"})}),(0,s.jsx)(n.Wu,{children:(0,s.jsx)("div",{className:"space-y-3",children:E.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-lg border",children:[(0,s.jsx)(o.S,{checked:e.completed,onCheckedChange:t=>I(e.id,!!t),disabled:!q||"completed"===C.status||"pending"===C.status}),(0,s.jsx)("span",{className:"flex-1 ".concat(e.completed?"line-through text-muted-foreground":""),children:e.title}),e.completed&&(0,s.jsx)(p.A,{className:"h-4 w-4 text-green-600"})]},e.id))})})]})]})}):(0,s.jsx)(N.O,{children:(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Goal not found"}),(0,s.jsxs)(l.$,{onClick:()=>_.push("/goals"),children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Back to Goals"]})]})})}},71360:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},78108:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});var s=a(12115);function r(e){let t=s.useRef({value:e,previous:e});return s.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}},83209:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>n,Zp:()=>i,aR:()=>l});var s=a(95155);a(12115);var r=a(25016);function i(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,r.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,r.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function n(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,r.cn)("leading-none font-semibold",t),...a})}function d(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,r.cn)("text-muted-foreground text-sm",t),...a})}function c(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,r.cn)("px-6",t),...a})}},84916:(e,t,a)=>{"use strict";a.d(t,{S:()=>n});var s=a(95155);a(12115);var r=a(38162),i=a(5917),l=a(25016);function n(e){let{className:t,...a}=e;return(0,s.jsx)(r.bL,{"data-slot":"checkbox",className:(0,l.cn)("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,s.jsx)(r.C1,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:(0,s.jsx)(i.A,{className:"size-3.5"})})})}}},e=>{e.O(0,[297,5707,8760,1370,3224,6227,8720,9885,8441,1255,7358],()=>e(e.s=911)),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5233],{21873:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},24245:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>j});var s=r(95155),a=r(12115),n=r(97003),i=r(33789),l=r(83209),c=r(33884),d=r(35626),o=r(86651),u=r(21873),m=r(96583),x=r(52619),h=r.n(x),f=r(19885),p=r(42855),N=r(18720);function j(){let[e,t]=(0,a.useState)(""),[r,x]=(0,a.useState)([]),[j,y]=(0,a.useState)(!1),[g,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{(async()=>{v(await p._.getCurrentUser())})()},[]);let _=async()=>{if(e.trim()&&g){y(!0);try{let{data:t,error:r}=await p.N.from("profiles").select("*").neq("id",g.id).eq("has_completed_kyc",!0).or("username.ilike.%".concat(e,"%,first_name.ilike.%").concat(e,"%,last_name.ilike.%").concat(e,"%")).limit(20);if(r)throw r;x(t||[])}catch(e){console.error("Search error:",e),N.oR.error("Search failed")}finally{y(!1)}}},b=async(e,t)=>{try{let{data:r}=await p.N.from("profiles").select("id").eq("id",e).single(),{data:s}=await p.N.from("profiles").select("id").eq("id",g.id).single();if(!r||!s)return void N.oR.error("User profile not found");let{data:a}=await p.N.from("accountability_partners").select("id, status").or("and(user_id.eq.".concat(g.id,",partner_id.eq.").concat(e,"),and(user_id.eq.").concat(e,",partner_id.eq.").concat(g.id,")")).maybeSingle();if(a)return void N.oR.error("pending"===a.status?"Request already sent":"Already partners");let{error:n}=await p.N.from("accountability_partners").insert({user_id:g.id,partner_id:e,status:"pending"});if(n){if("23503"===n.code)N.oR.error("User not found or invalid");else throw n;return}await p.N.from("notifications").insert({user_id:e,title:"New Partner Request",message:"Someone wants to be your accountability partner!",type:"partner_request",read:!1,data:{sender_id:g.id}}),N.oR.success("Request sent to ".concat(t,"!"))}catch(e){console.error("Follow request error:",e),N.oR.error(e.message||"Failed to send request")}};return(0,a.useEffect)(()=>{let t=setTimeout(()=>{e.trim()?_():x([])},500);return()=>clearTimeout(t)},[e,g]),(0,s.jsx)(f.O,{children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(h(),{href:"/partners",children:(0,s.jsx)(n.$,{variant:"outline",size:"icon",children:(0,s.jsx)(d.A,{className:"h-4 w-4"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Search Partners"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Find accountability partners"})]})]}),(0,s.jsx)(l.Zp,{children:(0,s.jsx)(l.Wu,{className:"p-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(o.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(i.p,{placeholder:"Search by username or name...",value:e,onChange:e=>t(e.target.value),className:"pl-10"})]})})}),j&&(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Searching..."})]}),r.length>0&&(0,s.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.map(e=>{var t,r;return(0,s.jsx)(l.Zp,{className:"hover-lift",children:(0,s.jsxs)(l.Wu,{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3 mb-3",children:[(0,s.jsxs)(c.eu,{className:"h-12 w-12",children:[(0,s.jsx)(c.BK,{src:e.profile_picture_url}),(0,s.jsxs)(c.q5,{children:[null==(t=e.first_name)?void 0:t.charAt(0),null==(r=e.last_name)?void 0:r.charAt(0)]})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("h3",{className:"font-semibold truncate",children:[e.first_name," ",e.last_name]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["@",e.username]}),e.location&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground mt-1",children:[(0,s.jsx)(u.A,{className:"h-3 w-3"}),e.location]})]})]}),e.bio&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:e.bio}),(0,s.jsxs)(n.$,{onClick:()=>b(e.id,"".concat(e.first_name," ").concat(e.last_name)),className:"w-full",size:"sm",children:[(0,s.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Send Request"]})]})},e.id)})}),e&&!j&&0===r.length&&(0,s.jsx)(l.Zp,{children:(0,s.jsxs)(l.Wu,{className:"py-12 text-center",children:[(0,s.jsx)(o.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"No users found"})]})})]})})}},35626:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},61563:(e,t,r)=>{Promise.resolve().then(r.bind(r,24245))},83209:(e,t,r)=>{"use strict";r.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>i});var s=r(95155);r(12115);var a=r(25016);function n(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...r})}function i(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...r})}function l(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",t),...r})}function c(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",t),...r})}function d(e){let{className:t,...r}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",t),...r})}},96583:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]])}},e=>{e.O(0,[297,5707,8760,1370,3224,6227,8720,9885,8441,1255,7358],()=>e(e.s=61563)),_N_E=e.O()}]);
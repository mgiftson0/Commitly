(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6173],{1746:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>w});var t=a(95155),s=a(12115),i=a(20063),n=a(52619),l=a.n(n),o=a(97003),d=a(83209),c=a(67812),m=a(33884),u=a(61362),p=a(30814),x=a(6613),h=a(91169),g=a(83457),f=a(85998);let y=(0,a(71847).A)("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var v=a(71360),b=a(19885),N=a(42855),j=a(18720);function w(){let[e,r]=(0,s.useState)([]),[a,n]=(0,s.useState)(!0),w=(0,i.useRouter)();(0,s.useEffect)(()=>{_()},[]);let _=async()=>{try{let e=await N._.getCurrentUser();if(!e)return void w.push("/auth/login");let{data:a,error:t}=await N.N.from("notifications").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(t)throw t;r(a||[])}catch(e){console.error("Error loading notifications:",e),j.oR.error("Failed to load notifications")}finally{n(!1)}},k=async e=>{try{let{error:a}=await N.N.from("notifications").update({read:!0}).eq("id",e);if(a)throw a;r(r=>r.map(r=>r.id===e?{...r,read:!0}:r))}catch(e){j.oR.error(e.message||"Failed to mark as read")}},q=async()=>{try{let e=await N._.getCurrentUser();if(!e)return;let{error:a}=await N.N.from("notifications").update({read:!0}).eq("user_id",e.id).eq("read",!1);if(a)throw a;r(e=>e.map(e=>({...e,read:!0}))),j.oR.success("All notifications marked as read")}catch(e){j.oR.error(e.message||"Failed to mark all as read")}},A=async e=>{try{let{error:a}=await N.N.from("notifications").delete().eq("id",e);if(a)throw a;r(r=>r.filter(r=>r.id!==e)),j.oR.success("Notification deleted")}catch(e){j.oR.error(e.message||"Failed to delete notification")}},C=async(e,r,a)=>{try{let t=await N._.getCurrentUser();if(!t)return;if("accept"===a){let{data:e}=await N.N.from("profiles").select("first_name, last_name, username").eq("id",t.id).single(),a=(null==e?void 0:e.first_name)?"".concat(e.first_name," ").concat(e.last_name||"").trim():(null==e?void 0:e.username)||"Someone",{error:s}=await N.N.from("accountability_partners").update({status:"accepted"}).eq("user_id",r).eq("partner_id",t.id).eq("status","pending");if(s)throw s;await N.N.from("notifications").insert({user_id:r,title:"Partner Request Accepted",message:"".concat(a," accepted your partner request!"),type:"partner_accepted",read:!1,data:{partner_id:t.id,partner_name:a}}),j.oR.success("Partner request accepted!")}else{let{error:e}=await N.N.from("accountability_partners").delete().eq("user_id",r).eq("partner_id",t.id).eq("status","pending");if(e)throw e;j.oR.success("Partner request declined")}await A(e)}catch(e){console.error("Error handling partner request:",e),j.oR.error(e.message||"Failed to process request")}},R=e.filter(e=>!e.read).length;return a?(0,t.jsx)(b.O,{children:(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(f.A,{className:"h-12 w-12 text-primary animate-pulse"})})}):(0,t.jsx)(b.O,{children:(0,t.jsxs)("div",{className:"space-y-4 sm:space-y-6 max-w-4xl mx-auto",children:[(0,t.jsxs)("div",{className:"relative overflow-hidden rounded-xl sm:rounded-2xl bg-gradient-to-br from-primary/10 via-primary/5 to-transparent p-4 sm:p-6 border border-primary/20",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 to-transparent opacity-50"}),(0,t.jsx)("div",{className:"relative",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3 sm:gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"Notifications"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground mt-1",children:R>0?(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-2 w-2 bg-primary rounded-full animate-pulse"}),R," unread notification",1!==R?"s":""]}):"All caught up! \uD83C\uDF89"})]}),R>0&&(0,t.jsxs)(o.$,{onClick:q,variant:"outline",className:"w-full sm:w-auto bg-background/50 backdrop-blur-sm border-primary/30 hover:bg-primary/10 hover:border-primary/50 transition-all duration-200",children:[(0,t.jsx)(y,{className:"h-4 w-4 mr-2"}),"Mark All Read"]})]})})]}),0===e.length?(0,t.jsx)(d.Zp,{className:"border-dashed border-2 border-primary/20 bg-gradient-to-br from-primary/5 to-transparent",children:(0,t.jsxs)(d.Wu,{className:"p-8 sm:p-12 text-center",children:[(0,t.jsxs)("div",{className:"relative inline-block",children:[(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/20 to-primary/10 rounded-full blur-xl opacity-50"}),(0,t.jsx)("div",{className:"relative bg-background rounded-full p-4 border border-primary/20",children:(0,t.jsx)(f.A,{className:"h-8 sm:h-12 w-8 sm:w-12 text-primary/60"})})]}),(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-semibold mt-4 mb-2 bg-gradient-to-r from-primary to-primary/70 bg-clip-text text-transparent",children:"No notifications yet"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-muted-foreground max-w-md mx-auto",children:"When you complete goals, receive encouragements, or get partner requests, they'll appear here."}),(0,t.jsx)(o.$,{variant:"outline",className:"mt-4 border-primary/30 hover:bg-primary/10",asChild:!0,children:(0,t.jsx)(l(),{href:"/goals",children:"Create Your First Goal"})})]})}):(0,t.jsx)("div",{className:"space-y-3 sm:space-y-4",children:e.map(e=>{var r,a,s,i,n;let l=(e=>{switch(e){case"goal_completed":return u.A;case"goal_created":return p.A;case"achievement_unlocked":return x.A;case"partner_request":case"goal_partner_request":return h.A;case"encouragement_received":return g.A;default:return f.A}})(e.type),y=(e=>{switch(e){case"goal_completed":return"text-green-600";case"goal_created":case"goal_partner_request":return"text-blue-600";case"achievement_unlocked":return"text-yellow-600";case"partner_request":return"text-purple-600";case"encouragement_received":return"text-pink-600";default:return"text-gray-600"}})(e.type);return(0,t.jsxs)(d.Zp,{className:"group relative overflow-hidden transition-all duration-300 hover:shadow-lg hover:shadow-primary/10 hover:scale-[1.01] border-l-4 ".concat(e.read?"border-l-muted bg-card":"border-l-primary bg-gradient-to-r from-primary/5 to-transparent shadow-md"),children:[!e.read&&(0,t.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary/5 via-primary/2 to-transparent opacity-50"}),(0,t.jsx)(d.Wu,{className:"p-3 sm:p-4 relative",children:(0,t.jsxs)("div",{className:"flex items-start gap-3 sm:gap-4",children:[(0,t.jsx)("div",{className:"relative flex-shrink-0 p-2 sm:p-3 rounded-xl bg-gradient-to-br ".concat(y.replace("text-","from-").replace("-600","-100")," ").concat(y.replace("text-","to-").replace("-600","-50")," border border-current/20"),children:(0,t.jsx)(l,{className:"h-4 sm:h-5 w-4 sm:w-5 ".concat(y," drop-shadow-sm")})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 space-y-2 sm:space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("h3",{className:"font-semibold text-sm sm:text-base mb-1 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"truncate",children:e.title}),!e.read&&(0,t.jsx)(c.E,{variant:"secondary",className:"bg-primary/10 text-primary border-primary/20 text-xs px-2 py-0.5 animate-pulse",children:"New"})]}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground leading-relaxed mb-2",children:e.message}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/70",children:(e=>{let r=Date.now()-new Date(e).getTime(),a=Math.floor(r/6e4),t=Math.floor(r/36e5),s=Math.floor(r/864e5);return s>0?"".concat(s,"d ago"):t>0?"".concat(t,"h ago"):a>0?"".concat(a,"m ago"):"Just now"})(e.created_at)})]}),(0,t.jsxs)("div",{className:"flex gap-1 flex-shrink-0",children:[!e.read&&(0,t.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>k(e.id),className:"h-8 w-8 p-0 hover:bg-primary/10 hover:text-primary transition-colors",children:(0,t.jsx)(u.A,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(o.$,{variant:"ghost",size:"sm",onClick:()=>A(e.id),className:"h-8 w-8 p-0 text-destructive/70 hover:text-destructive hover:bg-destructive/10 transition-colors",children:(0,t.jsx)(v.A,{className:"h-3.5 w-3.5"})})]})]}),(null==(r=e.data)?void 0:r.goal_id)&&(0,t.jsxs)(o.$,{variant:"outline",size:"sm",className:"w-full sm:w-auto text-xs sm:text-sm border-primary/30 hover:bg-primary/10 hover:border-primary/50 transition-all duration-200",onClick:()=>w.push("/goals/".concat(e.data.goal_id)),children:[(0,t.jsx)(p.A,{className:"h-3.5 w-3.5 mr-1.5"}),"View Goal"]}),"partner_request"===e.type&&(null==(a=e.data)?void 0:a.sender_id)&&(0,t.jsxs)("div",{className:"bg-muted/30 rounded-lg p-3 sm:p-4 border border-muted/50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)(m.eu,{className:"h-8 w-8 sm:h-10 sm:w-10",children:(0,t.jsx)(m.q5,{className:"text-xs bg-gradient-to-br from-primary/20 to-primary/10",children:(null==(s=e.data.sender_name)?void 0:s[0])||"U"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium truncate",children:e.data.sender_name||"User"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["@",e.data.sender_username||"user"]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:()=>C(e.id,e.data.sender_id,"decline"),className:"flex-1 text-xs sm:text-sm border-destructive/30 hover:bg-destructive/10 hover:border-destructive/50",children:"Decline"}),(0,t.jsx)(o.$,{size:"sm",onClick:()=>C(e.id,e.data.sender_id,"accept"),className:"flex-1 text-xs sm:text-sm bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70",children:"Accept"})]})]}),"goal_partner_request"===e.type&&(null==(i=e.data)?void 0:i.requester_id)&&(null==(n=e.data)?void 0:n.goal_id)&&(0,t.jsxs)(o.$,{variant:"outline",size:"sm",className:"w-full text-xs sm:text-sm border-primary/30 hover:bg-primary/10 hover:border-primary/50 transition-all duration-200",onClick:()=>w.push("/goals/".concat(e.data.goal_id)),children:[(0,t.jsx)(h.A,{className:"h-3.5 w-3.5 mr-1.5"}),"View Goal & Respond"]})]})]})})]},e.id)})}),(0,t.jsxs)("div",{className:"text-center py-4 sm:py-6 border-t border-muted/20",children:[(0,t.jsx)("p",{className:"text-xs sm:text-sm text-muted-foreground mb-2",children:"Want to learn more about Commitly?"}),(0,t.jsx)(o.$,{variant:"ghost",size:"sm",className:"text-primary hover:text-primary/80",asChild:!0,children:(0,t.jsx)(l(),{href:"/",children:"Visit Landing Page â†’"})})]})]})})}},61362:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(71847).A)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},71360:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(71847).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},83209:(e,r,a)=>{"use strict";a.d(r,{BT:()=>o,Wu:()=>d,ZB:()=>l,Zp:()=>i,aR:()=>n});var t=a(95155);a(12115);var s=a(25016);function i(e){let{className:r,...a}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...a})}function n(e){let{className:r,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...a})}function l(e){let{className:r,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",r),...a})}function o(e){let{className:r,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",r),...a})}function d(e){let{className:r,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",r),...a})}},83457:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});let t=(0,a(71847).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},92051:(e,r,a)=>{Promise.resolve().then(a.bind(a,1746))}},e=>{e.O(0,[297,5707,8760,1370,3224,6227,8720,9885,8441,1255,7358],()=>e(e.s=92051)),_N_E=e.O()}]);
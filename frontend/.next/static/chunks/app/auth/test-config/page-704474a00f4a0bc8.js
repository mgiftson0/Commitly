(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4527],{6132:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},25016:(e,s,a)=>{"use strict";a.d(s,{cn:()=>n});var t=a(2821),i=a(75889);function n(){for(var e=arguments.length,s=Array(e),a=0;a<e;a++)s[a]=arguments[a];return(0,i.QP)((0,t.$)(s))}},35299:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},37481:(e,s,a)=>{Promise.resolve().then(a.bind(a,89963))},42529:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},42855:(e,s,a)=>{"use strict";a.d(s,{N:()=>t,_:()=>i});let t=(0,a(78760).createClientComponentClient)(),i={signUp:async(e,s,a)=>{let{data:i,error:n}=await t.auth.signUp({email:e,password:s,options:{data:{full_name:a}}});if(n)throw n;return i},signIn:async(e,s)=>{let{data:a,error:i}=await t.auth.signInWithPassword({email:e,password:s});if(i)throw i;return a},signOut:async()=>{await t.auth.signOut()},signInWithGoogle:async()=>{let{data:e,error:s}=await t.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(s)throw s;return e},getCurrentUser:async()=>{let{data:{user:e}}=await t.auth.getUser();return e},getSession:async()=>{let{data:{session:e}}=await t.auth.getSession();return e},hasCompletedKyc:async()=>{let e=await i.getCurrentUser();if(!e)return!1;let{data:s}=await t.from("profiles").select("has_completed_kyc").eq("id",e.id).maybeSingle();return(null==s?void 0:s.has_completed_kyc)===!0},clearSession:async()=>{await t.auth.signOut()},resetPassword:async e=>{let{error:s}=await t.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password/confirm")});if(s)throw s},updatePassword:async e=>{let{error:s}=await t.auth.updateUser({password:e});if(s)throw s}}},83209:(e,s,a)=>{"use strict";a.d(s,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>r});var t=a(95155);a(12115);var i=a(25016);function n(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,i.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",s),...a})}function r(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,i.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...a})}function l(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,i.cn)("leading-none font-semibold",s),...a})}function c(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,i.cn)("text-muted-foreground text-sm",s),...a})}function d(e){let{className:s,...a}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,i.cn)("px-6",s),...a})}},89963:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>v});var t=a(95155),i=a(12115),n=a(83209),r=a(97003),l=a(42529);let c=(0,a(71847).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var d=a(35299),o=a(6132),m=a(85553);let u={auth:{enableGoogleOAuth:!1,requireEmailConfirmation:!0},features:{enableAchievements:!0,enableNotifications:!0,enableSocial:!0,enableProfileCustomization:!0},app:{name:"Commitly",supportEmail:"support@commitly.com",enableAnalytics:!1,enableErrorTracking:!1},dev:{enableDebugLogs:!1,enableTestFeatures:!1}};u.auth,u.features,u.app,u.dev;let h="https://gyygnbjffgmhxmmmirbf.supabase.co",x="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd5eWduYmpmZmdtaHhtbW1pcmJmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwNzY5MTgsImV4cCI6MjA3NjY1MjkxOH0.doRm5TN4TUIbs2BNIOFEhEDsgERfRB62djb4PA6ZVdA",g=!!(h&&x&&1),p=g?(0,m.UU)(h,x):null;var b=a(42855),f=a(52619),j=a.n(f);function v(){var e,s,a,m;let[u,h]=(0,i.useState)({envVars:!1,supabaseConnection:!1,hasSession:!1,emailConfirmed:!1,hasProfile:!1}),[x,f]=(0,i.useState)(!0),[v,y]=(0,i.useState)(null),[N,w]=(0,i.useState)(null);(0,i.useEffect)(()=>{C()},[]);let C=async()=>{f(!0),w(null);let e={};try{if(e.envVars=!0,e.supabaseConnection=g&&null!==p,e.supabaseConnection)try{let s=await b._.getSession();if(e.hasSession=!!s,y(s),null==s?void 0:s.user){e.emailConfirmed=!!s.user.email_confirmed_at;try{let{data:a}=await p.from("profiles").select("*").eq("id",s.user.id).single();e.hasProfile=!!a}catch(s){e.hasProfile=!1}}}catch(e){w("Session check failed: ".concat(e.message))}h(e)}catch(e){w("Diagnostic failed: ".concat(e.message))}finally{f(!1)}},S=async()=>{try{await b._.clearSession(),window.location.href="/auth/login"}catch(e){w("Clear session failed: ".concat(e.message))}},k=e=>{let{label:s,status:a}=e;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsx)("span",{className:"font-medium",children:s}),a?(0,t.jsx)(l.A,{className:"h-5 w-5 text-green-600"}):(0,t.jsx)(c,{className:"h-5 w-5 text-red-600"})]})};return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 p-8",children:(0,t.jsxs)("div",{className:"max-w-2xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"\uD83D\uDD0D Supabase Configuration Test"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Diagnose authentication and email verification issues"})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:"System Checks"}),(0,t.jsx)(r.$,{onClick:C,size:"sm",disabled:x,children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(d.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Running..."]}):"Re-run Checks"})]})}),(0,t.jsxs)(n.Wu,{className:"space-y-3",children:[x?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(d.A,{className:"h-8 w-8 animate-spin mx-auto mb-2 text-blue-600"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Running diagnostics..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k,{label:"Environment Variables Set",status:u.envVars}),(0,t.jsx)(k,{label:"Supabase Connected",status:u.supabaseConnection}),(0,t.jsx)(k,{label:"Active Session Exists",status:u.hasSession}),u.hasSession&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k,{label:"Email Verified",status:u.emailConfirmed}),(0,t.jsx)(k,{label:"Profile Created",status:u.hasProfile})]})]}),N&&(0,t.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(o.A,{className:"h-5 w-5 text-red-600 mt-0.5"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-red-900",children:"Error"}),(0,t.jsx)("p",{className:"text-sm text-red-700",children:N})]})]})})]})]}),v&&(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Current Session Info"})}),(0,t.jsx)(n.Wu,{className:"space-y-2",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,t.jsx)("div",{className:"font-medium",children:"User ID:"}),(0,t.jsx)("div",{className:"font-mono text-xs",children:null==(e=v.user)?void 0:e.id}),(0,t.jsx)("div",{className:"font-medium",children:"Email:"}),(0,t.jsx)("div",{children:null==(s=v.user)?void 0:s.email}),(0,t.jsx)("div",{className:"font-medium",children:"Email Confirmed:"}),(0,t.jsx)("div",{children:(null==(a=v.user)?void 0:a.email_confirmed_at)?(0,t.jsx)("span",{className:"text-green-600",children:"✓ Yes"}):(0,t.jsx)("span",{className:"text-red-600",children:"✗ No"})}),(0,t.jsx)("div",{className:"font-medium",children:"Created:"}),(0,t.jsx)("div",{className:"text-xs",children:new Date(null==(m=v.user)?void 0:m.created_at).toLocaleString()})]})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Issue Diagnosis"})}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[!u.envVars&&(0,t.jsxs)("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,t.jsx)("p",{className:"font-medium text-yellow-900",children:"❌ Environment Variables Missing"}),(0,t.jsxs)("p",{className:"text-sm text-yellow-700 mt-1",children:["Create a ",(0,t.jsx)("code",{className:"bg-yellow-100 px-1 rounded",children:".env.local"})," file with:"]}),(0,t.jsx)("pre",{className:"bg-yellow-100 p-2 rounded mt-2 text-xs overflow-x-auto",children:"NEXT_PUBLIC_SUPABASE_URL=your-project-url\nNEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key"})]}),u.hasSession&&!u.emailConfirmed&&(0,t.jsxs)("div",{className:"p-3 bg-orange-50 border border-orange-200 rounded-lg",children:[(0,t.jsx)("p",{className:"font-medium text-orange-900",children:"⚠️ Email Not Verified"}),(0,t.jsx)("p",{className:"text-sm text-orange-700 mt-1",children:"You have an active session but your email is not verified. This is why you're being redirected to KYC."}),(0,t.jsxs)("p",{className:"text-sm text-orange-700 mt-2",children:[(0,t.jsx)("strong",{children:"Solution:"})," Clear your session and sign up again with email confirmation enabled."]})]}),u.hasSession&&(0,t.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,t.jsx)("p",{className:"font-medium text-blue-900",children:"ℹ️ Old Session Detected"}),(0,t.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"You have an existing session. This is why the signup page redirects you to KYC."}),(0,t.jsx)(r.$,{onClick:S,className:"mt-2",size:"sm",children:"Clear Session & Start Fresh"})]}),!u.hasSession&&u.supabaseConnection&&(0,t.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,t.jsx)("p",{className:"font-medium text-green-900",children:"✓ Ready for Signup"}),(0,t.jsx)("p",{className:"text-sm text-green-700 mt-1",children:"No active session. You can now test the signup flow."}),(0,t.jsxs)("p",{className:"text-sm text-green-700 mt-2",children:[(0,t.jsx)("strong",{children:"Next step:"})," Ensure email confirmation is enabled in Supabase Dashboard."]})]})]})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Quick Actions"})}),(0,t.jsxs)(n.Wu,{className:"space-y-2",children:[(0,t.jsx)(j(),{href:"/auth/signup",children:(0,t.jsx)(r.$,{className:"w-full",variant:"outline",children:"Go to Signup Page"})}),(0,t.jsx)(j(),{href:"/auth/login",children:(0,t.jsx)(r.$,{className:"w-full",variant:"outline",children:"Go to Login Page"})}),u.hasSession&&(0,t.jsx)(r.$,{onClick:S,className:"w-full",variant:"destructive",children:"Clear Session & Logout"})]})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Supabase Email Setup"})}),(0,t.jsxs)(n.Wu,{className:"space-y-3 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"1. Enable Email Confirmation"}),(0,t.jsx)("p",{className:"text-gray-600",children:'Supabase Dashboard → Authentication → Providers → Email → Enable "Confirm email" ✓'})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"2. Configure Email Template"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Supabase Dashboard → Authentication → Email Templates → Confirm signup"}),(0,t.jsx)("code",{className:"block bg-gray-100 p-2 rounded mt-1",children:"{{ .SiteURL }}/auth/callback"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"3. Check Auth Logs"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Supabase Dashboard → Logs → Auth Logs (to see if emails are being sent)"})]})]})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Environment Info"})}),(0,t.jsx)(n.Wu,{className:"text-sm space-y-2",children:(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsx)("div",{className:"font-medium",children:"Supabase URL:"}),(0,t.jsx)("div",{className:"font-mono text-xs truncate",children:"https://gyygnbjffgmhxmmmirbf.supabase.co"}),(0,t.jsx)("div",{className:"font-medium",children:"Anon Key:"}),(0,t.jsx)("div",{className:"font-mono text-xs",children:"".concat("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd5eWduYmpmZmdtaHhtbW1pcmJmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwNzY5MTgsImV4cCI6MjA3NjY1MjkxOH0.doRm5TN4TUIbs2BNIOFEhEDsgERfRB62djb4PA6ZVdA".substring(0,20),"...")}),(0,t.jsx)("div",{className:"font-medium",children:"Has Supabase:"}),(0,t.jsx)("div",{children:g&&null!==p?"✓ Yes":"✗ No"})]})})]})]})})}},97003:(e,s,a)=>{"use strict";a.d(s,{$:()=>c,r:()=>l});var t=a(95155);a(12115);var i=a(32467),n=a(83101),r=a(25016);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:s,variant:a,size:n,asChild:c=!1,...d}=e,o=c?i.DX:"button";return(0,t.jsx)(o,{"data-slot":"button",className:(0,r.cn)(l({variant:a,size:n,className:s})),...d})}}},e=>{e.O(0,[297,5707,8760,8441,1255,7358],()=>e(e.s=37481)),_N_E=e.O()}]);
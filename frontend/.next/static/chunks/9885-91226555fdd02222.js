"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9885],{7220:(e,t,a)=>{a.d(t,{SQ:()=>o,_2:()=>c,lp:()=>d,mB:()=>m,rI:()=>i,ty:()=>l});var s=a(95155);a(12115);var r=a(47971),n=a(25016);function i(e){let{...t}=e;return(0,s.jsx)(r.bL,{"data-slot":"dropdown-menu",...t})}function l(e){let{...t}=e;return(0,s.jsx)(r.l9,{"data-slot":"dropdown-menu-trigger",...t})}function o(e){let{className:t,sideOffset:a=4,...i}=e;return(0,s.jsx)(r.ZL,{children:(0,s.jsx)(r.UC,{"data-slot":"dropdown-menu-content",sideOffset:a,className:(0,n.cn)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...i})})}function c(e){let{className:t,inset:a,variant:i="default",...l}=e;return(0,s.jsx)(r.q7,{"data-slot":"dropdown-menu-item","data-inset":a,"data-variant":i,className:(0,n.cn)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...l})}function d(e){let{className:t,inset:a,...i}=e;return(0,s.jsx)(r.JU,{"data-slot":"dropdown-menu-label","data-inset":a,className:(0,n.cn)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",t),...i})}function m(e){let{className:t,...a}=e;return(0,s.jsx)(r.wv,{"data-slot":"dropdown-menu-separator",className:(0,n.cn)("bg-border -mx-1 my-1 h-px",t),...a})}},19885:(e,t,a)=>{a.d(t,{O:()=>Z});var s=a(95155),r=a(12115),n=a(97003),i=a(33884),l=a(7220),o=a(89511),c=a(65229),d=a(25016);function m(e){let{...t}=e;return(0,s.jsx)(o.bL,{"data-slot":"sheet",...t})}function u(e){let{...t}=e;return(0,s.jsx)(o.l9,{"data-slot":"sheet-trigger",...t})}function h(e){let{...t}=e;return(0,s.jsx)(o.ZL,{"data-slot":"sheet-portal",...t})}function g(e){let{className:t,...a}=e;return(0,s.jsx)(o.hJ,{"data-slot":"sheet-overlay",className:(0,d.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...a})}function x(e){let{className:t,children:a,side:r="right",...n}=e;return(0,s.jsxs)(h,{children:[(0,s.jsx)(g,{}),(0,s.jsxs)(o.UC,{"data-slot":"sheet-content",className:(0,d.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===r&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===r&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===r&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===r&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",t),...n,children:[a,(0,s.jsxs)(o.bm,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,s.jsx)(c.A,{className:"size-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}var f=a(37494),p=a(59427),v=a(79451),b=a(9540),j=a(30814),w=a(91169),y=a(20508),N=a(15870),k=a(84926),S=a(86651),_=a(85998),C=a(5379),A=a(52619),D=a.n(A),z=a(20063),E=a(33789),q=a(67812),I=a(52472),P=a(26983),$=a(42855);function L(e){let{className:t,placeholder:a="Search goals, users, achievements..."}=e,[l,o]=(0,r.useState)(""),[m,u]=(0,r.useState)([]),[h,g]=(0,r.useState)(!1),[x,f]=(0,r.useState)([]),p=(0,z.useRouter)(),v=(0,r.useRef)(null),b=(0,r.useCallback)(e=>{let t=[e,...x.filter(t=>t!==e)].slice(0,5);f(t),localStorage.setItem("recentSearches",JSON.stringify(t))},[x]),y=(0,r.useCallback)(async e=>{if(e.length<2)return void u([]);let t=[],a=e.toLowerCase();try{let{data:s,error:r}=await $.N.from("profiles").select("id, username, first_name, last_name, profile_picture_url").or("username.ilike.%".concat(a,"%,first_name.ilike.%").concat(a,"%,last_name.ilike.%").concat(a,"%")).limit(5);!r&&s?s.forEach(a=>{let s="".concat(a.first_name||""," ").concat(a.last_name||"").trim()||a.username||"User",r=a.username||"no-username";t.push({id:a.id,type:"user",title:s,description:"@".concat(r),avatar:a.profile_picture_url||void 0,onClick:()=>{p.push("/profile/".concat(r)),b(e),g(!1)}})}):r&&console.error("User search error:",r);let{data:n,error:i}=await $.N.from("goals").select("id, title, description, category, status, progress").ilike("title","%".concat(a,"%")).eq("visibility","public").limit(5);!i&&n&&n.forEach(a=>{t.push({id:a.id,type:"goal",title:a.title,description:a.description||"Public goal",category:a.category,status:a.status,progress:a.progress,onClick:()=>{p.push("/goals/".concat(a.id)),b(e),g(!1)}})})}catch(e){console.warn("Search error:",e)}t.sort((e,t)=>"user"===e.type&&"user"!==t.type?-1:+("user"!==e.type&&"user"===t.type)),u(t.slice(0,8))},[p,b]);return(0,r.useEffect)(()=>{try{let e=localStorage.getItem("recentSearches");if(e){let t=JSON.parse(e);Array.isArray(t)&&f(t)}}catch(e){console.warn("Failed to load recent searches:",e),localStorage.removeItem("recentSearches")}},[]),(0,r.useEffect)(()=>{let e=setTimeout(()=>{l.length>0?y(l):u([])},500);return()=>clearTimeout(e)},[l,y]),(0,s.jsxs)("div",{className:(0,d.cn)("relative",t),children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(S.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,s.jsx)(E.p,{ref:v,value:l,onChange:e=>o(e.target.value),onFocus:()=>g(!0),placeholder:a,className:"pl-10 pr-10"}),l&&(0,s.jsx)(n.$,{variant:"ghost",size:"sm",className:"absolute right-1 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0",onClick:()=>{o(""),u([])},children:(0,s.jsx)(c.A,{className:"h-3 w-3"})})]}),h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>g(!1)}),(0,s.jsxs)("div",{className:"absolute top-full left-0 right-0 mt-2 bg-background border rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:[0===l.length&&x.length>0&&(0,s.jsxs)("div",{className:"p-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsx)("span",{className:"text-sm font-medium text-muted-foreground",children:"Recent Searches"}),(0,s.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>{f([]),localStorage.removeItem("recentSearches")},className:"h-6 text-xs",children:"Clear"})]}),(0,s.jsx)("div",{className:"space-y-1",children:x.map((e,t)=>(0,s.jsxs)("button",{className:"flex items-center gap-2 w-full p-2 text-left hover:bg-accent rounded text-sm",onClick:()=>{var t;o(e),null==(t=v.current)||t.focus()},children:[(0,s.jsx)(P.A,{className:"h-3 w-3 text-muted-foreground"}),e]},t))})]}),l.length>0&&0===m.length&&(0,s.jsxs)("div",{className:"p-4 text-center text-muted-foreground",role:"status","aria-live":"polite",children:[(0,s.jsx)(S.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50","aria-hidden":"true"}),(0,s.jsxs)("p",{className:"text-sm mb-2",children:["No results found for “",l,"”"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground/80",children:"Try adjusting your search terms or browse categories"})]}),m.length>0&&(0,s.jsxs)("div",{className:"p-2",children:[(0,s.jsxs)("div",{className:"text-xs font-medium text-muted-foreground mb-2 px-2",children:[m.length," result",1!==m.length?"s":""]}),(0,s.jsx)("div",{className:"space-y-1",children:m.map(e=>{let t=(e=>{switch(e){case"goal":return j.A;case"user":return w.A;case"achievement":return I.A;case"notification":return _.A;default:return S.A}})(e.type);return(0,s.jsxs)("button",{className:"flex items-center gap-3 w-full p-2 text-left hover:bg-accent rounded transition-colors",onClick:e.onClick,children:["user"===e.type?(0,s.jsxs)(i.eu,{className:"h-8 w-8",children:[(0,s.jsx)(i.BK,{src:e.avatar}),(0,s.jsx)(i.q5,{className:"text-xs",children:e.title.split(" ").map(e=>e[0]).join("")})]}):(0,s.jsx)("div",{className:"p-2 rounded-full bg-muted",children:(0,s.jsx)(t,{className:"h-4 w-4 ".concat((e=>{switch(e){case"goal":return"text-blue-600";case"user":return"text-purple-600";case"achievement":return"text-yellow-600";case"notification":return"text-green-600";default:return"text-gray-600"}})(e.type))})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium text-sm truncate",children:e.title}),e.status&&(0,s.jsx)(q.E,{variant:"outline",className:"text-xs",children:e.status}),void 0!==e.progress&&(0,s.jsxs)(q.E,{variant:"secondary",className:"text-xs",children:[e.progress,"%"]})]}),e.description&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.description})]}),(0,s.jsx)(q.E,{variant:"outline",className:"text-xs capitalize",children:e.type})]},e.id)})})]})]})]})]})}function J(e){var t,a;let{onMenuClick:o}=e,{theme:c,setTheme:d}=(0,C.D)(),[h,g]=(0,r.useState)(!1),[A,E]=(0,r.useState)(!1),[q,I]=(0,r.useState)(!1),[P,J]=(0,r.useState)(0),[U,O]=(0,r.useState)(null);(0,z.useRouter)(),r.useEffect(()=>{g(!0)},[]);let F=()=>{try{let e=JSON.parse(localStorage.getItem("notifications")||"[]").filter(e=>!e.is_read).length;J(e)}catch(e){J(0)}},G=async()=>{try{let e=await $._.getCurrentUser();if(e){let{data:t}=await $.N.from("profiles").select("*").eq("id",e.id).maybeSingle();O({...t,email:e.email})}}catch(e){console.error("Error loading profile:",e)}};(0,r.useEffect)(()=>{F(),G();let e=()=>{I(!0),F(),setTimeout(()=>I(!1),1e3)};return window.addEventListener("newNotification",e),window.addEventListener("storage",F),()=>{window.removeEventListener("newNotification",e),window.removeEventListener("storage",F)}},[]);let W=async()=>{try{await $._.signOut(),localStorage.clear(),sessionStorage.clear(),window.location.replace("/auth/login")}catch(e){console.error("Logout error:",e),localStorage.clear(),sessionStorage.clear(),window.location.replace("/auth/login")}},R=()=>h?(0,s.jsxs)(l.rI,{children:[(0,s.jsx)(l.ty,{asChild:!0,children:(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"hover-lift",children:"dark"===c?(0,s.jsx)(f.A,{className:"h-5 w-5"}):"light"===c?(0,s.jsx)(p.A,{className:"h-5 w-5"}):(0,s.jsx)(v.A,{className:"h-5 w-5"})})}),(0,s.jsxs)(l.SQ,{align:"end",children:[(0,s.jsxs)(l._2,{onClick:()=>d("light"),children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Light"]}),(0,s.jsxs)(l._2,{onClick:()=>d("dark"),children:[(0,s.jsx)(f.A,{className:"mr-2 h-4 w-4"}),"Dark"]}),(0,s.jsxs)(l._2,{onClick:()=>d("system"),children:[(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"System"]})]})]}):null;return(0,s.jsx)("header",{className:"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,s.jsxs)("div",{className:"container flex h-14 md:h-16 items-center justify-between px-3 sm:px-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,s.jsxs)(m,{children:[(0,s.jsx)(u,{asChild:!0,children:(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"md:hidden",children:(0,s.jsx)(b.A,{className:"h-5 w-5"})})}),(0,s.jsx)(x,{side:"left",className:"w-64 p-0",children:(0,s.jsxs)("div",{className:"flex h-full flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-3 border-b",children:[(0,s.jsx)(j.A,{className:"h-5 w-5 text-primary"}),(0,s.jsx)("span",{className:"text-base font-bold",children:"Commitly"})]}),(0,s.jsxs)("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[(0,s.jsx)(n.$,{variant:"ghost",className:"w-full justify-start h-9 text-sm",asChild:!0,children:(0,s.jsxs)(D(),{href:"/dashboard",children:[(0,s.jsx)(j.A,{className:"h-4 w-4 mr-2"})," Dashboard"]})}),(0,s.jsx)(n.$,{variant:"ghost",className:"w-full justify-start h-9 text-sm",asChild:!0,children:(0,s.jsxs)(D(),{href:"/goals",children:[(0,s.jsx)(j.A,{className:"h-4 w-4 mr-2"})," Goals"]})}),(0,s.jsx)(n.$,{variant:"ghost",className:"w-full justify-start h-9 text-sm",asChild:!0,children:(0,s.jsxs)(D(),{href:"/partners",children:[(0,s.jsx)(w.A,{className:"h-4 w-4 mr-2"})," Partners"]})}),(0,s.jsx)(n.$,{variant:"ghost",className:"w-full justify-start h-9 text-sm",asChild:!0,children:(0,s.jsxs)(D(),{href:"/profile",children:[(0,s.jsx)(y.A,{className:"h-4 w-4 mr-2"})," Profile"]})}),(0,s.jsx)(n.$,{variant:"ghost",className:"w-full justify-start h-9 text-sm",asChild:!0,children:(0,s.jsxs)(D(),{href:"/settings",children:[(0,s.jsx)(N.A,{className:"h-4 w-4 mr-2"})," Settings"]})})]}),(0,s.jsxs)("div",{className:"border-t p-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:(0,s.jsx)("span",{children:"Theme"})}),(0,s.jsx)("div",{children:(0,s.jsx)(R,{})})]}),(0,s.jsxs)(n.$,{variant:"outline",className:"w-full mt-2",onClick:W,children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"})," Logout"]})]})]})})]}),(0,s.jsxs)(D(),{href:"/dashboard",className:"flex items-center gap-2 hover-lift",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-primary to-primary/60 rounded-lg blur opacity-75"}),(0,s.jsx)("div",{className:"relative bg-background rounded-lg p-1 border",children:(0,s.jsx)(j.A,{className:"h-5 w-5 text-primary"})})]}),(0,s.jsx)("span",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-primary to-primary/80 bg-clip-text text-transparent",children:"Commitly"})]})]}),(0,s.jsx)("div",{className:"hidden md:flex flex-1 max-w-md mx-4 sm:mx-8",children:(0,s.jsx)(L,{className:"w-full"})}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[(0,s.jsxs)(m,{open:A,onOpenChange:E,children:[(0,s.jsx)(u,{asChild:!0,children:(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"md:hidden",children:(0,s.jsx)(S.A,{className:"h-5 w-5"})})}),(0,s.jsx)(x,{side:"top",className:"p-4",children:(0,s.jsx)(L,{className:"w-full"})})]}),(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"hover-lift relative",onClick:F,asChild:!0,children:(0,s.jsxs)(D(),{href:"/notifications",children:[(0,s.jsx)(_.A,{className:"h-5 w-5 transition-transform duration-200 ".concat(q?"animate-bounce":"")}),P>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 h-5 w-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center animate-pulse",children:P>9?"9+":P})]})}),(0,s.jsx)("div",{className:"hidden md:block",children:(0,s.jsx)(R,{})}),(0,s.jsxs)(l.rI,{children:[(0,s.jsx)(l.ty,{asChild:!0,children:(0,s.jsx)(n.$,{variant:"ghost",className:"relative h-10 w-10 rounded-full hover-lift",children:(0,s.jsxs)(i.eu,{className:"h-10 w-10",children:[(0,s.jsx)(i.BK,{src:null==U?void 0:U.profile_picture_url}),(0,s.jsx)(i.q5,{className:"bg-primary text-primary-foreground",children:U?"".concat((null==(t=U.first_name)?void 0:t[0])||"J").concat((null==(a=U.last_name)?void 0:a[0])||"D"):"JD"})]})})}),(0,s.jsxs)(l.SQ,{className:"w-56",align:"end",forceMount:!0,children:[(0,s.jsx)(l.lp,{className:"font-normal",children:(0,s.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium leading-none",children:U&&"".concat(U.first_name||""," ").concat(U.last_name||"").trim()||"User"}),(0,s.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:(null==U?void 0:U.email)||"user@example.com"})]})}),(0,s.jsx)(l.mB,{}),(0,s.jsx)(l._2,{asChild:!0,children:(0,s.jsxs)(D(),{href:"/profile",className:"cursor-pointer",children:[(0,s.jsx)(y.A,{className:"mr-2 h-4 w-4"}),"Profile"]})}),(0,s.jsx)(l._2,{asChild:!0,children:(0,s.jsxs)(D(),{href:"/settings",className:"cursor-pointer",children:[(0,s.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Settings"]})}),(0,s.jsx)(l.mB,{}),(0,s.jsxs)(l._2,{onClick:W,className:"cursor-pointer",children:[(0,s.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Log out"]})]})]})]})]})})}var U=a(55850),O=a(54664),F=a(65993),G=a(1524),W=a(6191),R=a(27937),T=a(90368),M=a(6613),B=a(97643);function K(e){let{className:t}=e,[a,l]=(0,r.useState)(!1),[o,c]=(0,r.useState)("all"),[m,u]=(0,r.useState)([]),[h,g]=(0,r.useState)({goals:0,partners:0,completed:0,pending:0}),x=(0,z.usePathname)(),{theme:b,setTheme:y}=(0,C.D)(),N=[{name:"Dashboard",href:"/dashboard",icon:F.A,current:"/dashboard"===x},{name:"Goals",href:"/goals",icon:j.A,current:x.startsWith("/goals"),badge:h.goals.toString()},{name:"Search",href:"/search",icon:S.A,current:x.startsWith("/search")},{name:"Partners",href:"/partners",icon:w.A,current:x.startsWith("/partners"),badge:h.partners.toString()},{name:"Analytics",href:"/analytics",icon:G.A,current:x.startsWith("/analytics")}],_=[{name:"Create Goal",href:"/goals/create",icon:W.A,color:"bg-primary text-primary-foreground"},{name:"Find Partners",href:"/partners/search",icon:w.A,color:"bg-accent text-accent-foreground"}],A=[{id:1,title:"Morning Workout",progress:75,type:"recurring",streak:12,category:"Health & Fitness"},{id:2,title:"Read 30 minutes",progress:45,type:"single",streak:5,category:"Learning"},{id:3,title:"Learn Spanish",progress:30,type:"multi",streak:8,category:"Learning"},{id:4,title:"Meditation Practice",progress:60,type:"recurring",streak:15,category:"Wellness"},{id:5,title:"Project Planning",progress:20,type:"single",streak:3,category:"Career"}];return("all"===o?A:A.filter(e=>{switch(o){case"health":return"Health & Fitness"===e.category;case"learning":return"Learning"===e.category;case"career":return"Career"===e.category;case"wellness":return"Wellness"===e.category;case"recurring":return"recurring"===e.type;case"single":return"single"===e.type;case"multi":return"multi"===e.type;default:return!0}})).slice(0,3),(0,r.useEffect)(()=>{(async()=>{try{let e=await $._.getCurrentUser();if(!e)return;let{data:t}=await $.N.from("goals").select("*").eq("user_id",e.id),{data:a}=await $.N.from("accountability_partners").select("*").or("user_id.eq.".concat(e.id,",partner_id.eq.").concat(e.id)).eq("status","accepted"),s=t||[],r=s.filter(e=>e.completed_at).length,n=s.filter(e=>!e.completed_at&&!e.is_suspended).length;g({goals:s.length,partners:(a||[]).length,completed:r,pending:n}),u([])}catch(e){console.error("Error loading sidebar stats:",e)}})()},[]),(0,r.useEffect)(()=>{let e=()=>{try{let e=localStorage.getItem("goals"),t=e?JSON.parse(e):[],a={encouragementsSent:parseInt(localStorage.getItem("encouragementsSent")||"0")},s=(0,B.$)(t,a).filter(e=>!e.unlocked&&e.progressPercentage>=50).sort((e,t)=>t.progressPercentage-e.progressPercentage).slice(0,3);u(s)}catch(e){u([])}};return window.addEventListener("goalUpdated",e),window.addEventListener("goalDeleted",e),window.addEventListener("storage",e),()=>{window.removeEventListener("goalUpdated",e),window.removeEventListener("goalDeleted",e),window.removeEventListener("storage",e)}},[]),(0,s.jsxs)("div",{className:(0,d.cn)("flex h-full flex-col border-r bg-card transition-all duration-300 text-[13px] sm:text-[14px]",a?"w-14":"w-56 md:w-72",t),children:[(0,s.jsxs)("div",{className:"flex h-14 md:h-16 items-center justify-between px-3 sm:px-4 border-b",children:[!a&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.A,{className:"h-6 w-6 text-primary"}),(0,s.jsx)("span",{className:"text-lg font-bold",children:"Commitly"})]}),(0,s.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>l(!a),className:"h-8 w-8",children:a?(0,s.jsx)(R.A,{className:"h-4 w-4"}):(0,s.jsx)(T.A,{className:"h-4 w-4"})})]}),a&&(0,s.jsx)("div",{className:"p-3 border-b md:hidden",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(i.eu,{className:"h-10 w-10",children:[(0,s.jsx)(i.BK,{src:"/placeholder-avatar.jpg"}),(0,s.jsx)(i.q5,{className:"bg-primary text-primary-foreground font-bold",children:(()=>{try{let a=localStorage.getItem("kycData");if(a){var e,t;let s=JSON.parse(a);return"".concat((null==(e=s.firstName)?void 0:e[0])||"J").concat((null==(t=s.lastName)?void 0:t[0])||"D")}}catch(e){}return"JD"})()})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"font-medium text-sm truncate",children:(()=>{try{let e=localStorage.getItem("kycData");if(e){let t=JSON.parse(e);return"".concat(t.firstName||"John"," ").concat(t.lastName||"Doe")}}catch(e){}return"John Doe"})()}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground truncate",children:["@",(()=>{try{let e=localStorage.getItem("kycData");if(e)return JSON.parse(e).username||"johndoe"}catch(e){}return"johndoe"})()]})]})]})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto scrollbar-thin",children:[(0,s.jsx)("nav",{className:"p-3 sm:p-4 space-y-1.5",children:N.map(e=>{let t=e.icon;return(0,s.jsx)(D(),{href:e.href,children:(0,s.jsxs)("div",{className:(0,d.cn)("flex items-center gap-2.5 px-2.5 py-2 rounded-lg text-[13px] sm:text-sm font-medium transition-all duration-200 hover:bg-accent hover:text-accent-foreground",e.current&&"bg-primary text-primary-foreground shadow-sm",a&&"justify-center px-0"),children:[(0,s.jsx)(t,{className:"h-5 w-5 flex-shrink-0"}),!a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"flex-1",children:e.name}),e.badge&&(0,s.jsx)(q.E,{variant:"secondary",className:"text-xs",children:e.badge})]})]})},e.name)})}),(0,s.jsx)(O.w,{className:"mx-4"}),!a&&(0,s.jsxs)("div",{className:"p-3 sm:p-4",children:[(0,s.jsx)("h3",{className:"mb-3 text-sm font-semibold text-muted-foreground uppercase tracking-wider",children:"Quick Actions"}),(0,s.jsx)("div",{className:"space-y-2",children:_.map(e=>{let t=e.icon;return(0,s.jsx)(D(),{href:e.href,children:(0,s.jsxs)(n.$,{variant:"outline",className:"w-full justify-start h-auto py-3 px-3 hover-lift",children:[(0,s.jsx)("div",{className:(0,d.cn)("p-1.5 rounded-md mr-3",e.color),children:(0,s.jsx)(t,{className:"h-4 w-4"})}),(0,s.jsx)("span",{className:"text-sm",children:e.name})]})},e.name)})})]}),(0,s.jsx)(O.w,{className:"mx-4"}),!a&&(0,s.jsxs)("div",{className:"p-3 sm:p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider",children:"Close to Unlock"}),(0,s.jsx)(M.A,{className:"h-6 w-6 text-yellow-500 animate-pulse"})]}),(0,s.jsx)("div",{className:"space-y-3",children:m.map(e=>(e.icon,(0,s.jsx)(D(),{href:"/achievements",children:(0,s.jsxs)("div",{className:"p-1 rounded border backdrop-blur-sm hover:backdrop-blur-md transition-all hover-lift ".concat((()=>{switch(e.rarity){case"common":default:return"bg-gradient-to-br from-gray-100/80 to-gray-200/80 dark:from-gray-800/80 dark:to-gray-900/80 border-gray-300/50";case"rare":return"bg-gradient-to-br from-blue-100/80 to-blue-200/80 dark:from-blue-900/80 dark:to-blue-800/80 border-blue-300/50";case"epic":return"bg-gradient-to-br from-purple-100/80 to-purple-200/80 dark:from-purple-900/80 dark:to-purple-800/80 border-purple-300/50";case"legendary":return"bg-gradient-to-br from-yellow-100/80 to-orange-200/80 dark:from-yellow-900/80 dark:to-orange-800/80 border-yellow-300/50"}})()),children:[(0,s.jsxs)("div",{className:"flex items-start gap-1 mb-1",children:[(0,s.jsx)("div",{className:"p-1 rounded ".concat((()=>{switch(e.rarity){case"common":default:return"bg-gray-200/60 dark:bg-gray-700/60";case"rare":return"bg-blue-200/60 dark:bg-blue-700/60";case"epic":return"bg-purple-200/60 dark:bg-purple-700/60";case"legendary":return"bg-yellow-200/60 dark:bg-yellow-700/60"}})()," backdrop-blur-sm"),children:(0,s.jsx)(M.A,{className:"h-3.5 w-3.5 text-yellow-600 dark:text-yellow-400"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h4",{className:"text-[11px] font-semibold line-clamp-1 mb-0.5",children:e.title}),(0,s.jsx)("div",{className:"inline-block px-1.5 py-0.5 rounded-full text-[9px] font-medium ".concat("common"===e.rarity?"bg-gray-200 text-gray-700 dark:bg-gray-700 dark:text-gray-300":"rare"===e.rarity?"bg-blue-200 text-blue-700 dark:bg-blue-700 dark:text-blue-300":"epic"===e.rarity?"bg-purple-200 text-purple-700 dark:bg-purple-700 dark:text-purple-300":"bg-yellow-200 text-yellow-700 dark:bg-yellow-700 dark:text-yellow-300"),children:e.rarity})]})]}),(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-xs",children:[(0,s.jsx)("span",{className:"text-muted-foreground font-medium",children:"Progress"}),(0,s.jsxs)("span",{className:"font-bold",children:[e.progress,"/",e.total]})]}),(0,s.jsx)(U.k,{value:e.progressPercentage,className:"h-1 ".concat(e.progressPercentage>=90?"[&>div]:bg-green-500":"[&>div]:bg-orange-500")})]})]})},e.id)))}),!a&&(0,s.jsx)(D(),{href:"/achievements",children:(0,s.jsx)(n.$,{variant:"ghost",className:"w-full mt-4 text-sm backdrop-blur-sm",children:"View All Achievements"})})]}),!a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O.w,{className:"mx-4"}),(0,s.jsxs)("div",{className:"p-3 sm:p-4",children:[(0,s.jsx)("h3",{className:"mb-2 sm:mb-3 text-xs sm:text-sm font-semibold text-muted-foreground uppercase tracking-wider",children:"Today's Summary"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-primary",children:h.completed}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Completed"})]}),(0,s.jsxs)("div",{className:"text-center p-3 rounded-lg bg-muted/50",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-accent",children:h.pending}),(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Pending"})]})]})]})]})]}),(0,s.jsx)("div",{className:"p-3 sm:p-4 border-t mt-auto",children:a?(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>y("light"),title:"Light",children:(0,s.jsx)(p.A,{className:"h-4 w-4"})}),(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>y("dark"),title:"Dark",children:(0,s.jsx)(f.A,{className:"h-4 w-4"})}),(0,s.jsx)(D(),{href:"/",children:(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-8 w-8",title:"Logout",children:(0,s.jsx)(k.A,{className:"h-4 w-4"})})})]}):(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:"Theme"}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>y("light"),title:"Light",children:(0,s.jsx)(p.A,{className:"h-4 w-4"})}),(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>y("dark"),title:"Dark",children:(0,s.jsx)(f.A,{className:"h-4 w-4"})}),(0,s.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>y("system"),title:"System",children:(0,s.jsx)(v.A,{className:"h-4 w-4"})})]})]}),(0,s.jsx)(D(),{href:"/",children:(0,s.jsxs)(n.$,{variant:"outline",className:"w-full",children:[(0,s.jsx)(k.A,{className:"h-4 w-4 mr-2"})," Logout"]})})]})})]})}var Q=a(31233);class H{static getInstance(){return H.instance||(H.instance=new H),H.instance}start(){this.intervalId=setInterval(()=>{this.checkDueDates()},36e5),this.checkDueDates()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}checkDueDates(){try{let e=JSON.parse(localStorage.getItem("goals")||"[]"),t=new Date;e.forEach(e=>{if(!e.dueDate||e.completedAt||"active"!==e.status)return;let a=new Date(e.dueDate),s=a.getTime()-t.getTime(),r=Math.ceil(s/864e5);if(r<=1&&r>=0){let t="due-".concat(e.id,"-").concat(a.toDateString());localStorage.getItem(t)||(Q.$.goalDueSoon(e.title,r),localStorage.setItem(t,"true"))}})}catch(e){console.error("Error checking due dates:",e)}}constructor(){this.intervalId=null}}let V=H.getInstance(),X=(0,r.createContext)(void 0);function Y(e){let{children:t}=e,[a,n]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{try{let e=localStorage.getItem("kycData");if(e){let t=JSON.parse(e);n({id:"mock-user-id",username:"johndoe",firstName:t.firstName||"John",lastName:t.lastName||"Doe",email:t.email})}else n({id:"mock-user-id",username:"johndoe",firstName:"John",lastName:"Doe"})}catch(e){n({id:"mock-user-id",username:"johndoe",firstName:"John",lastName:"Doe"})}l(!1)},[]),(0,s.jsx)(X.Provider,{value:{user:a,setUser:n,isLoading:i},children:t})}function Z(e){let{children:t}=e;return(0,r.useEffect)(()=>(Q.$.init(),V.start(),()=>{V.stop()}),[]),(0,s.jsx)(Y,{children:(0,s.jsxs)("div",{className:"flex h-screen bg-background",children:[(0,s.jsx)("aside",{className:"hidden md:block",children:(0,s.jsx)(K,{})}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,s.jsx)(J,{}),(0,s.jsx)("main",{className:"flex-1 overflow-y-auto scrollbar-thin",children:(0,s.jsx)("div",{className:"container mx-auto px-3 sm:px-4 py-4 sm:py-6 animate-fade-in text-[13.5px] sm:text-[14.5px] md:text-base leading-tight sm:leading-relaxed",children:t})})]})]})})}},25016:(e,t,a)=>{a.d(t,{cn:()=>n});var s=a(2821),r=a(75889);function n(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},31233:(e,t,a)=>{a.d(t,{$:()=>r});class s{static getInstance(){return s.instance||(s.instance=new s),s.instance}async init(){if("serviceWorker"in navigator&&"Notification"in window)try{(await fetch("/sw.js",{method:"HEAD"})).ok?this.registration=await navigator.serviceWorker.register("/sw.js"):console.log("Service worker file not found, notifications will work without service worker"),await this.requestPermission()}catch(e){console.log("Service worker registration skipped:",e instanceof Error?e.message:String(e)),await this.requestPermission()}}async requestPermission(){if(!("Notification"in window))return!1;try{let e=await Notification.requestPermission();return"granted"===e}catch(e){return console.log("Notification permission request failed:",e instanceof Error?e.message:String(e)),!1}}async sendNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!("Notification"in window)||!await this.requestPermission())return;let a={icon:"/icon-192x192.png",badge:"/icon-192x192.png",tag:"commitly-notification",...t};this.registration?await this.registration.showNotification(e,a):new Notification(e,a)}async goalCreated(e){await this.sendNotification("\uD83C\uDFAF New Goal Created!",{body:'"'.concat(e,'" has been added to your goals'),tag:"goal-created"})}async goalCompleted(e){await this.sendNotification("\uD83C\uDF89 Goal Completed!",{body:'Congratulations! You completed "'.concat(e,'"'),tag:"goal-completed"})}async goalDueSoon(e,t){await this.sendNotification("⏰ Goal Due Soon",{body:'"'.concat(e,'" is due in ').concat(t," day").concat(1!==t?"s":""),tag:"goal-due"})}async partnerRequest(e){await this.sendNotification("\uD83D\uDC65 New Partner Request",{body:"".concat(e," wants to be your accountability partner"),tag:"partner-request"})}async partnerAccepted(e){await this.sendNotification("✅ Partner Request Accepted",{body:"".concat(e," accepted your accountability partner request"),tag:"partner-accepted"})}async partnerDeclined(e){await this.sendNotification("❌ Partner Request Declined",{body:"".concat(e," declined your accountability partner request"),tag:"partner-declined"})}async newFollower(e){await this.sendNotification("\uD83D\uDC64 New Follower",{body:"".concat(e," started following you"),tag:"new-follower"})}async encouragementReceived(e,t){await this.sendNotification("\uD83D\uDCAA Encouragement Received",{body:"".concat(e,' sent you encouragement for "').concat(t,'"'),tag:"encouragement"})}constructor(){this.registration=null}}let r=s.getInstance()},33789:(e,t,a)=>{a.d(t,{p:()=>n});var s=a(95155);a(12115);var r=a(25016);function n(e){let{className:t,type:a,...n}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:(0,r.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...n})}},33884:(e,t,a)=>{a.d(t,{BK:()=>l,eu:()=>i,q5:()=>o});var s=a(95155);a(12115);var r=a(46591),n=a(25016);function i(e){let{className:t,...a}=e;return(0,s.jsx)(r.bL,{"data-slot":"avatar",className:(0,n.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t),...a})}function l(e){let{className:t,...a}=e;return(0,s.jsx)(r._V,{"data-slot":"avatar-image",className:(0,n.cn)("aspect-square size-full",t),...a})}function o(e){let{className:t,...a}=e;return(0,s.jsx)(r.H4,{"data-slot":"avatar-fallback",className:(0,n.cn)("bg-muted flex size-full items-center justify-center rounded-full",t),...a})}},42855:(e,t,a)=>{a.d(t,{N:()=>s,_:()=>r});let s=(0,a(78760).createClientComponentClient)(),r={signUp:async(e,t,a)=>{let{data:r,error:n}=await s.auth.signUp({email:e,password:t,options:{data:{full_name:a}}});if(n)throw n;return r},signIn:async(e,t)=>{let{data:a,error:r}=await s.auth.signInWithPassword({email:e,password:t});if(r)throw r;return a},signOut:async()=>{await s.auth.signOut()},signInWithGoogle:async()=>{let{data:e,error:t}=await s.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback")}});if(t)throw t;return e},getCurrentUser:async()=>{let{data:{user:e}}=await s.auth.getUser();return e},getSession:async()=>{let{data:{session:e}}=await s.auth.getSession();return e},hasCompletedKyc:async()=>{let e=await r.getCurrentUser();if(!e)return!1;let{data:t}=await s.from("profiles").select("has_completed_kyc").eq("id",e.id).maybeSingle();return(null==t?void 0:t.has_completed_kyc)===!0},clearSession:async()=>{await s.auth.signOut()},resetPassword:async e=>{let{error:t}=await s.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/auth/reset-password/confirm")});if(t)throw t}}},54664:(e,t,a)=>{a.d(t,{w:()=>i});var s=a(95155);a(12115);var r=a(57268),n=a(25016);function i(e){let{className:t,orientation:a="horizontal",decorative:i=!0,...l}=e;return(0,s.jsx)(r.b,{"data-slot":"separator",decorative:i,orientation:a,className:(0,n.cn)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t),...l})}},55850:(e,t,a)=>{a.d(t,{k:()=>i});var s=a(95155);a(12115);var r=a(9484),n=a(25016);function i(e){let{className:t,indicatorClassName:a,value:i,...l}=e;return(0,s.jsx)(r.bL,{"data-slot":"progress",className:(0,n.cn)("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",t),...l,children:(0,s.jsx)(r.C1,{"data-slot":"progress-indicator",className:(0,n.cn)("h-full w-full flex-1 bg-primary transition-all",a),style:{transform:"translateX(-".concat(100-(i||0),"%)")}})})}},67812:(e,t,a)=>{a.d(t,{E:()=>o});var s=a(95155);a(12115);var r=a(32467),n=a(83101),i=a(25016);let l=(0,n.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function o(e){let{className:t,variant:a,asChild:n=!1,...o}=e,c=n?r.DX:"span";return(0,s.jsx)(c,{"data-slot":"badge",className:(0,i.cn)(l({variant:a}),t),...o})}},97003:(e,t,a)=>{a.d(t,{$:()=>o,r:()=>l});var s=a(95155);a(12115);var r=a(32467),n=a(83101),i=a(25016);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:t,variant:a,size:n,asChild:o=!1,...c}=e,d=o?r.DX:"button";return(0,s.jsx)(d,{"data-slot":"button",className:(0,i.cn)(l({variant:a,size:n,className:t})),...c})}},97643:(e,t,a)=>{a.d(t,{$:()=>n,checkAndUnlockAchievements:()=>i,d:()=>r});var s=a(42855);let r=[{id:"first-goal",name:"First Goal",title:"First Goal",description:"Create your first goal",icon:"target",rarity:"common",condition:(e,t)=>({unlocked:e.length>=1,progress:Math.min(e.length,1),total:1})},{id:"goal-achiever",name:"Goal Achiever",title:"Goal Achiever",description:"Complete your first goal",icon:"trophy",rarity:"common",condition:(e,t)=>({unlocked:e.filter(e=>"completed"===e.status||e.completed_at).length>=1,progress:Math.min(e.filter(e=>"completed"===e.status||e.completed_at).length,1),total:1})},{id:"goal-master",name:"Goal Master",title:"Goal Master",description:"Complete 10 goals",icon:"star",rarity:"rare",condition:(e,t)=>({unlocked:e.filter(e=>"completed"===e.status||e.completed_at).length>=10,progress:e.filter(e=>"completed"===e.status||e.completed_at).length,total:10})}];function n(e,t){return r.map(a=>{let s=a.condition(e,t);return{...a,unlocked:s.unlocked,progress:s.progress,total:s.total,progressPercentage:Math.round(s.progress/s.total*100)}})}async function i(e,t,a){try{let{data:a}=await s.N.from("user_achievements").select("achievement_id").eq("user_id",e),r=new Set((null==a?void 0:a.map(e=>e.achievement_id))||[]),{data:n}=await s.N.from("achievements").select("*");if(!n)return;let i=[];for(let a of n){if(r.has(a.id))continue;let n=!1;switch(a.name){case"First Goal":if("goal_created"===t){let{data:t}=await s.N.from("goals").select("id").eq("user_id",e);n=((null==t?void 0:t.length)||0)>=1}break;case"Goal Achiever":if("goal_completed"===t){let{data:t}=await s.N.from("goals").select("id").eq("user_id",e).eq("status","completed");n=((null==t?void 0:t.length)||0)>=1}break;case"Goal Master":if("goal_completed"===t){let{data:t}=await s.N.from("goals").select("id").eq("user_id",e).eq("status","completed");n=((null==t?void 0:t.length)||0)>=10}break;case"Social Butterfly":if("partner_added"===t){let{data:t}=await s.N.from("accountability_partners").select("id").or("user_id.eq.".concat(e,",partner_id.eq.").concat(e)).eq("status","accepted");n=((null==t?void 0:t.length)||0)>=1}}n&&(await s.N.from("user_achievements").insert({user_id:e,achievement_id:a.id}),await s.N.from("notifications").insert({user_id:e,title:"Achievement Unlocked!",message:'You earned "'.concat(a.name,'" - ').concat(a.description),type:"achievement_unlocked",read:!1,data:{achievement_id:a.id}}),i.push(a))}return i}catch(e){return console.error("Error checking achievements:",e),[]}}}}]);
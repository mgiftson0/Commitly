"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_lib_achievement-tracker-db_ts"],{

/***/ "(app-pages-browser)/./lib/achievement-tracker-db.ts":
/*!***************************************!*\
  !*** ./lib/achievement-tracker-db.ts ***!
  \***************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkAndUnlockAchievements: () => (/* binding */ checkAndUnlockAchievements),\n/* harmony export */   getAchievementProgress: () => (/* binding */ getAchievementProgress),\n/* harmony export */   getUserAchievements: () => (/* binding */ getUserAchievements),\n/* harmony export */   triggerAchievementCheck: () => (/* binding */ triggerAchievementCheck)\n/* harmony export */ });\n/* harmony import */ var _supabase_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./supabase-client */ \"(app-pages-browser)/./lib/supabase-client.ts\");\n/**\n * Database-backed Achievement Tracking System\n * Tracks and unlocks achievements based on user goals and activities\n */ \n// Achievement definitions will be fetched from database\n// import { ACHIEVEMENTS } from \"./achievements\";\n/**\n * Check for newly unlocked achievements and save to database\n */ async function checkAndUnlockAchievements() {\n    try {\n        const user = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.authHelpers.getCurrentUser();\n        if (!user) return [];\n        // Get user's goals from database\n        const { data: goals, error: goalsError } = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('goals').select('*').eq('user_id', user.id);\n        if (goalsError) throw goalsError;\n        // Get user's already unlocked achievements\n        const { data: unlockedAchievements, error: achievementsError } = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_achievements').select('achievement_id').eq('user_id', user.id);\n        if (achievementsError) throw achievementsError;\n        const unlockedIds = new Set((unlockedAchievements || []).map((ua)=>ua.achievement_id));\n        const userStats = {\n            encouragementsSent: 0 // TODO: implement encouragement tracking\n        };\n        // Get achievements from database\n        const { data: achievements, error: achievementsDefError } = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('achievements').select('*');\n        if (achievementsDefError) throw achievementsDefError;\n        // Check each achievement\n        const newlyUnlocked = [];\n        for (const achievement of achievements || []){\n            // Skip if already unlocked\n            if (unlockedIds.has(achievement.id)) continue;\n            // Check if conditions are met based on achievement type\n            let shouldUnlock = false;\n            switch(achievement.name){\n                case 'First Goal':\n                    shouldUnlock = ((goals === null || goals === void 0 ? void 0 : goals.length) || 0) >= 1;\n                    break;\n                case 'Goal Achiever':\n                    shouldUnlock = ((goals === null || goals === void 0 ? void 0 : goals.filter((g)=>g.status === 'completed').length) || 0) >= 1;\n                    break;\n                case 'Goal Master':\n                    shouldUnlock = ((goals === null || goals === void 0 ? void 0 : goals.filter((g)=>g.status === 'completed').length) || 0) >= 10;\n                    break;\n                default:\n                    shouldUnlock = false;\n            }\n            if (shouldUnlock) {\n                // Save to database\n                const { error: insertError } = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_achievements').insert({\n                    user_id: user.id,\n                    achievement_id: achievement.id,\n                    unlocked_at: new Date().toISOString()\n                });\n                if (!insertError) {\n                    // Create notification\n                    await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('notifications').insert({\n                        user_id: user.id,\n                        title: 'Achievement Unlocked!',\n                        message: \"You've unlocked \\\"\".concat(achievement.title, '\" - ').concat(achievement.description),\n                        type: 'achievement_unlocked',\n                        read: false,\n                        data: {\n                            achievement_id: achievement.id,\n                            rarity: achievement.rarity\n                        }\n                    });\n                    newlyUnlocked.push(achievement);\n                    // Trigger celebration event\n                    if (true) {\n                        window.dispatchEvent(new CustomEvent('achievementUnlocked', {\n                            detail: achievement\n                        }));\n                    }\n                }\n            }\n        }\n        return newlyUnlocked;\n    } catch (error) {\n        console.error('Error checking achievements:', error);\n        return [];\n    }\n}\n/**\n * Trigger achievement check with debounce\n */ function triggerAchievementCheck() {\n    if (true) {\n        clearTimeout(window.achievementCheckTimeout);\n        window.achievementCheckTimeout = setTimeout(()=>{\n            checkAndUnlockAchievements();\n        }, 1000);\n    }\n}\n/**\n * Get user's unlocked achievements from database\n */ async function getUserAchievements() {\n    try {\n        const user = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.authHelpers.getCurrentUser();\n        if (!user) return [];\n        const { data, error } = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('user_achievements').select('*').eq('user_id', user.id).order('unlocked_at', {\n            ascending: false\n        });\n        if (error) throw error;\n        return data || [];\n    } catch (error) {\n        console.error('Error getting user achievements:', error);\n        return [];\n    }\n}\n/**\n * Get achievement progress for a specific achievement\n */ async function getAchievementProgress(achievementId) {\n    try {\n        const user = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.authHelpers.getCurrentUser();\n        if (!user) return null;\n        // Get achievement definition from database\n        const { data: achievements, error: achievementError } = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('achievements').select('*').eq('id', achievementId).single();\n        if (achievementError || !achievements) return null;\n        const achievement = achievements;\n        // Get user's goals\n        const { data: goals, error } = await _supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from('goals').select('*').eq('user_id', user.id);\n        if (error) throw error;\n        const userStats = {\n            encouragementsSent: 0\n        };\n        // Calculate progress based on achievement type\n        let progress = 0;\n        let total = 1;\n        switch(achievement.name){\n            case 'First Goal':\n                progress = Math.min((goals === null || goals === void 0 ? void 0 : goals.length) || 0, 1);\n                total = 1;\n                break;\n            case 'Goal Achiever':\n                progress = Math.min((goals === null || goals === void 0 ? void 0 : goals.filter((g)=>g.status === 'completed').length) || 0, 1);\n                total = 1;\n                break;\n            case 'Goal Master':\n                progress = Math.min((goals === null || goals === void 0 ? void 0 : goals.filter((g)=>g.status === 'completed').length) || 0, 10);\n                total = 10;\n                break;\n        }\n        return {\n            achievement,\n            progress,\n            total,\n            unlocked: progress >= total,\n            percentage: Math.round(progress / total * 100)\n        };\n    } catch (error) {\n        console.error('Error getting achievement progress:', error);\n        return null;\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2xpYi9hY2hpZXZlbWVudC10cmFja2VyLWRiLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7OztDQUdDLEdBRXlEO0FBQzFELHdEQUF3RDtBQUN4RCxpREFBaUQ7QUFFakQ7O0NBRUMsR0FDTSxlQUFlRTtJQUNwQixJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRix5REFBV0EsQ0FBQ0csY0FBYztRQUM3QyxJQUFJLENBQUNELE1BQU0sT0FBTyxFQUFFO1FBRXBCLGlDQUFpQztRQUNqQyxNQUFNLEVBQUVFLE1BQU1DLEtBQUssRUFBRUMsT0FBT0MsVUFBVSxFQUFFLEdBQUcsTUFBTVIsc0RBQVFBLENBQ3REUyxJQUFJLENBQUMsU0FDTEMsTUFBTSxDQUFDLEtBQ1BDLEVBQUUsQ0FBQyxXQUFXUixLQUFLUyxFQUFFO1FBRXhCLElBQUlKLFlBQVksTUFBTUE7UUFFdEIsMkNBQTJDO1FBQzNDLE1BQU0sRUFBRUgsTUFBTVEsb0JBQW9CLEVBQUVOLE9BQU9PLGlCQUFpQixFQUFFLEdBQUcsTUFBTWQsc0RBQVFBLENBQzVFUyxJQUFJLENBQUMscUJBQ0xDLE1BQU0sQ0FBQyxrQkFDUEMsRUFBRSxDQUFDLFdBQVdSLEtBQUtTLEVBQUU7UUFFeEIsSUFBSUUsbUJBQW1CLE1BQU1BO1FBRTdCLE1BQU1DLGNBQWMsSUFBSUMsSUFBSSxDQUFDSCx3QkFBd0IsRUFBRSxFQUFFSSxHQUFHLENBQUNDLENBQUFBLEtBQU1BLEdBQUdDLGNBQWM7UUFDcEYsTUFBTUMsWUFBWTtZQUNoQkMsb0JBQW9CLEVBQUUseUNBQXlDO1FBQ2pFO1FBRUEsaUNBQWlDO1FBQ2pDLE1BQU0sRUFBRWhCLE1BQU1pQixZQUFZLEVBQUVmLE9BQU9nQixvQkFBb0IsRUFBRSxHQUFHLE1BQU12QixzREFBUUEsQ0FDdkVTLElBQUksQ0FBQyxnQkFDTEMsTUFBTSxDQUFDO1FBRVYsSUFBSWEsc0JBQXNCLE1BQU1BO1FBRWhDLHlCQUF5QjtRQUN6QixNQUFNQyxnQkFB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QU93QixNQUFNLENBQUNDLENBQUFBLElBQUtBLEVBQUVDLE1BQU0sS0FBSyxhQUFhSCxNQUFNLEtBQUksR0FBRztnQkFDOUVrQyxRQUFRO2dCQUNSO1FBQ0o7UUFFQSxPQUFPO1lBQ0x0QztZQUNBcUM7WUFDQUM7WUFDQUcsVUFBVUosWUFBWUM7WUFDdEJJLFlBQVlILEtBQUtJLEtBQUssQ0FBQyxXQUFZTCxRQUFTO1FBQzlDO0lBQ0YsRUFBRSxPQUFPeEQsT0FBTztRQUNkMkMsUUFBUTNDLEtBQUssQ0FBQyx1Q0FBdUNBO1FBQ3JELE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXG1naWZ0XFxPbmVEcml2ZVxcRGVza3RvcFxcQ29tbWl0bHlcXENvbW1pdGx5XFxmcm9udGVuZFxcbGliXFxhY2hpZXZlbWVudC10cmFja2VyLWRiLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogRGF0YWJhc2UtYmFja2VkIEFjaGlldmVtZW50IFRyYWNraW5nIFN5c3RlbVxuICogVHJhY2tzIGFuZCB1bmxvY2tzIGFjaGlldmVtZW50cyBiYXNlZCBvbiB1c2VyIGdvYWxzIGFuZCBhY3Rpdml0aWVzXG4gKi9cblxuaW1wb3J0IHsgc3VwYWJhc2UsIGF1dGhIZWxwZXJzIH0gZnJvbSBcIi4vc3VwYWJhc2UtY2xpZW50XCI7XG4vLyBBY2hpZXZlbWVudCBkZWZpbml0aW9ucyB3aWxsIGJlIGZldGNoZWQgZnJvbSBkYXRhYmFzZVxuLy8gaW1wb3J0IHsgQUNISUVWRU1FTlRTIH0gZnJvbSBcIi4vYWNoaWV2ZW1lbnRzXCI7XG5cbi8qKlxuICogQ2hlY2sgZm9yIG5ld2x5IHVubG9ja2VkIGFjaGlldmVtZW50cyBhbmQgc2F2ZSB0byBkYXRhYmFzZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY2hlY2tBbmRVbmxvY2tBY2hpZXZlbWVudHMoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGF1dGhIZWxwZXJzLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgaWYgKCF1c2VyKSByZXR1cm4gW107XG5cbiAgICAvLyBHZXQgdXNlcidzIGdvYWxzIGZyb20gZGF0YWJhc2VcbiAgICBjb25zdCB7IGRhdGE6IGdvYWxzLCBlcnJvcjogZ29hbHNFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdnb2FscycpXG4gICAgICAuc2VsZWN0KCcqJylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpO1xuXG4gICAgaWYgKGdvYWxzRXJyb3IpIHRocm93IGdvYWxzRXJyb3I7XG5cbiAgICAvLyBHZXQgdXNlcidzIGFscmVhZHkgdW5sb2NrZWQgYWNoaWV2ZW1lbnRzXG4gICAgY29uc3QgeyBkYXRhOiB1bmxvY2tlZEFjaGlldmVtZW50cywgZXJyb3I6IGFjaGlldmVtZW50c0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJfYWNoaWV2ZW1lbnRzJylcbiAgICAgIC5zZWxlY3QoJ2FjaGlldmVtZW50X2lkJylcbiAgICAgIC5lcSgndXNlcl9pZCcsIHVzZXIuaWQpO1xuXG4gICAgaWYgKGFjaGlldmVtZW50c0Vycm9yKSB0aHJvdyBhY2hpZXZlbWVudHNFcnJvcjtcblxuICAgIGNvbnN0IHVubG9ja2VkSWRzID0gbmV3IFNldCgodW5sb2NrZWRBY2hpZXZlbWVudHMgfHwgW10pLm1hcCh1YSA9PiB1YS5hY2hpZXZlbWVudF9pZCkpO1xuICAgIGNvbnN0IHVzZXJTdGF0cyA9IHtcbiAgICAgIGVuY291cmFnZW1lbnRzU2VudDogMCAvLyBUT0RPOiBpbXBsZW1lbnQgZW5jb3VyYWdlbWVudCB0cmFja2luZ1xuICAgIH07XG5cbiAgICAvLyBHZXQgYWNoaWV2ZW1lbnRzIGZyb20gZGF0YWJhc2VcbiAgICBjb25zdCB7IGRhdGE6IGFjaGlldmVtZW50cywgZXJyb3I6IGFjaGlldmVtZW50c0RlZkVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2FjaGlldmVtZW50cycpXG4gICAgICAuc2VsZWN0KCcqJyk7XG5cbiAgICBpZiAoYWNoaWV2ZW1lbnRzRGVmRXJyb3IpIHRocm93IGFjaGlldmVtZW50c0RlZkVycm9yO1xuXG4gICAgLy8gQ2hlY2sgZWFjaCBhY2hpZXZlbWVudFxuICAgIGNvbnN0IG5ld2x5VW5sb2NrZWQgPSBbXTtcbiAgICBcbiAgICBmb3IgKGNvbnN0IGFjaGlldmVtZW50IG9mIGFjaGlldmVtZW50cyB8fCBbXSkge1xuICAgICAgLy8gU2tpcCBpZiBhbHJlYWR5IHVubG9ja2VkXG4gICAgICBpZiAodW5sb2NrZWRJZHMuaGFzKGFjaGlldmVtZW50LmlkKSkgY29udGludWU7XG5cbiAgICAgIC8vIENoZWNrIGlmIGNvbmRpdGlvbnMgYXJlIG1ldCBiYXNlZCBvbiBhY2hpZXZlbWVudCB0eXBlXG4gICAgICBsZXQgc2hvdWxkVW5sb2NrID0gZmFsc2U7XG4gICAgICBcbiAgICAgIHN3aXRjaCAoYWNoaWV2ZW1lbnQubmFtZSkge1xuICAgICAgICBjYXNlICdGaXJzdCBHb2FsJzpcbiAgICAgICAgICBzaG91bGRVbmxvY2sgPSAoZ29hbHM/Lmxlbmd0aCB8fCAwKSA+PSAxO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdHb2FsIEFjaGlldmVyJzpcbiAgICAgICAgICBzaG91bGRVbmxvY2sgPSAoZ29hbHM/LmZpbHRlcihnID0+IGcuc3RhdHVzID09PSAnY29tcGxldGVkJykubGVuZ3RoIHx8IDApID49IDE7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ0dvYWwgTWFzdGVyJzpcbiAgICAgICAgICBzaG91bGRVbmxvY2sgPSAoZ29hbHM/LmZpbHRlcihnID0+IGcuc3RhdHVzID09PSAnY29tcGxldGVkJykubGVuZ3RoIHx8IDApID49IDEwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHNob3VsZFVubG9jayA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoc2hvdWxkVW5sb2NrKSB7XG4gICAgICAgIC8vIFNhdmUgdG8gZGF0YWJhc2VcbiAgICAgICAgY29uc3QgeyBlcnJvcjogaW5zZXJ0RXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgICAgLmZyb20oJ3VzZXJfYWNoaWV2ZW1lbnRzJylcbiAgICAgICAgICAuaW5zZXJ0KHtcbiAgICAgICAgICAgIHVzZXJfaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICBhY2hpZXZlbWVudF9pZDogYWNoaWV2ZW1lbnQuaWQsXG4gICAgICAgICAgICB1bmxvY2tlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFpbnNlcnRFcnJvcikge1xuICAgICAgICAgIC8vIENyZWF0ZSBub3RpZmljYXRpb25cbiAgICAgICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ25vdGlmaWNhdGlvbnMnKVxuICAgICAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgICAgIHVzZXJfaWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICAgIHRpdGxlOiAnQWNoaWV2ZW1lbnQgVW5sb2NrZWQhJyxcbiAgICAgICAgICAgICAgbWVzc2FnZTogYFlvdSd2ZSB1bmxvY2tlZCBcIiR7YWNoaWV2ZW1lbnQudGl0bGV9XCIgLSAke2FjaGlldmVtZW50LmRlc2NyaXB0aW9ufWAsXG4gICAgICAgICAgICAgIHR5cGU6ICdhY2hpZXZlbWVudF91bmxvY2tlZCcsXG4gICAgICAgICAgICAgIHJlYWQ6IGZhbHNlLFxuICAgICAgICAgICAgICBkYXRhOiB7IFxuICAgICAgICAgICAgICAgIGFjaGlldmVtZW50X2lkOiBhY2hpZXZlbWVudC5pZCwgXG4gICAgICAgICAgICAgICAgcmFyaXR5OiBhY2hpZXZlbWVudC5yYXJpdHkgXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgbmV3bHlVbmxvY2tlZC5wdXNoKGFjaGlldmVtZW50KTtcblxuICAgICAgICAgIC8vIFRyaWdnZXIgY2VsZWJyYXRpb24gZXZlbnRcbiAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KFxuICAgICAgICAgICAgICBuZXcgQ3VzdG9tRXZlbnQoJ2FjaGlldmVtZW50VW5sb2NrZWQnLCB7XG4gICAgICAgICAgICAgICAgZGV0YWlsOiBhY2hpZXZlbWVudFxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbmV3bHlVbmxvY2tlZDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBhY2hpZXZlbWVudHM6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIFRyaWdnZXIgYWNoaWV2ZW1lbnQgY2hlY2sgd2l0aCBkZWJvdW5jZVxuICovXG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlckFjaGlldmVtZW50Q2hlY2soKSB7XG4gIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgIGNsZWFyVGltZW91dCgod2luZG93IGFzIGFueSkuYWNoaWV2ZW1lbnRDaGVja1RpbWVvdXQpO1xuICAgICh3aW5kb3cgYXMgYW55KS5hY2hpZXZlbWVudENoZWNrVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgY2hlY2tBbmRVbmxvY2tBY2hpZXZlbWVudHMoKTtcbiAgICB9LCAxMDAwKTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCB1c2VyJ3MgdW5sb2NrZWQgYWNoaWV2ZW1lbnRzIGZyb20gZGF0YWJhc2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFVzZXJBY2hpZXZlbWVudHMoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGF1dGhIZWxwZXJzLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgaWYgKCF1c2VyKSByZXR1cm4gW107XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3VzZXJfYWNoaWV2ZW1lbnRzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgIC5vcmRlcigndW5sb2NrZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuICAgIHJldHVybiBkYXRhIHx8IFtdO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgdXNlciBhY2hpZXZlbWVudHM6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhY2hpZXZlbWVudCBwcm9ncmVzcyBmb3IgYSBzcGVjaWZpYyBhY2hpZXZlbWVudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0QWNoaWV2ZW1lbnRQcm9ncmVzcyhhY2hpZXZlbWVudElkOiBzdHJpbmcpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgYXV0aEhlbHBlcnMuZ2V0Q3VycmVudFVzZXIoKTtcbiAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsO1xuXG4gICAgLy8gR2V0IGFjaGlldmVtZW50IGRlZmluaXRpb24gZnJvbSBkYXRhYmFzZVxuICAgIGNvbnN0IHsgZGF0YTogYWNoaWV2ZW1lbnRzLCBlcnJvcjogYWNoaWV2ZW1lbnRFcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdhY2hpZXZlbWVudHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2lkJywgYWNoaWV2ZW1lbnRJZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChhY2hpZXZlbWVudEVycm9yIHx8ICFhY2hpZXZlbWVudHMpIHJldHVybiBudWxsO1xuICAgIGNvbnN0IGFjaGlldmVtZW50ID0gYWNoaWV2ZW1lbnRzO1xuXG4gICAgLy8gR2V0IHVzZXIncyBnb2Fsc1xuICAgIGNvbnN0IHsgZGF0YTogZ29hbHMsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2dvYWxzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZCk7XG5cbiAgICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuXG4gICAgY29uc3QgdXNlclN0YXRzID0ge1xuICAgICAgZW5jb3VyYWdlbWVudHNTZW50OiAwXG4gICAgfTtcblxuICAgIC8vIENhbGN1bGF0ZSBwcm9ncmVzcyBiYXNlZCBvbiBhY2hpZXZlbWVudCB0eXBlXG4gICAgbGV0IHByb2dyZXNzID0gMDtcbiAgICBsZXQgdG90YWwgPSAxO1xuICAgIFxuICAgIHN3aXRjaCAoYWNoaWV2ZW1lbnQubmFtZSkge1xuICAgICAgY2FzZSAnRmlyc3QgR29hbCc6XG4gICAgICAgIHByb2dyZXNzID0gTWF0aC5taW4oZ29hbHM/Lmxlbmd0aCB8fCAwLCAxKTtcbiAgICAgICAgdG90YWwgPSAxO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0dvYWwgQWNoaWV2ZXInOlxuICAgICAgICBwcm9ncmVzcyA9IE1hdGgubWluKGdvYWxzPy5maWx0ZXIoZyA9PiBnLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpLmxlbmd0aCB8fCAwLCAxKTtcbiAgICAgICAgdG90YWwgPSAxO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ0dvYWwgTWFzdGVyJzpcbiAgICAgICAgcHJvZ3Jlc3MgPSBNYXRoLm1pbihnb2Fscz8uZmlsdGVyKGcgPT4gZy5zdGF0dXMgPT09ICdjb21wbGV0ZWQnKS5sZW5ndGggfHwgMCwgMTApO1xuICAgICAgICB0b3RhbCA9IDEwO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGFjaGlldmVtZW50LFxuICAgICAgcHJvZ3Jlc3MsXG4gICAgICB0b3RhbCxcbiAgICAgIHVubG9ja2VkOiBwcm9ncmVzcyA+PSB0b3RhbCxcbiAgICAgIHBlcmNlbnRhZ2U6IE1hdGgucm91bmQoKHByb2dyZXNzIC8gdG90YWwpICogMTAwKVxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBhY2hpZXZlbWVudCBwcm9ncmVzczonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJzdXBhYmFzZSIsImF1dGhIZWxwZXJzIiwiY2hlY2tBbmRVbmxvY2tBY2hpZXZlbWVudHMiLCJ1c2VyIiwiZ2V0Q3VycmVudFVzZXIiLCJkYXRhIiwiZ29hbHMiLCJlcnJvciIsImdvYWxzRXJyb3IiLCJmcm9tIiwic2VsZWN0IiwiZXEiLCJpZCIsInVubG9ja2VkQWNoaWV2ZW1lbnRzIiwiYWNoaWV2ZW1lbnRzRXJyb3IiLCJ1bmxvY2tlZElkcyIsIlNldCIsIm1hcCIsInVhIiwiYWNoaWV2ZW1lbnRfaWQiLCJ1c2VyU3RhdHMiLCJlbmNvdXJhZ2VtZW50c1NlbnQiLCJhY2hpZXZlbWVudHMiLCJhY2hpZXZlbWVudHNEZWZFcnJvciIsIm5ld2x5VW5sb2NrZWQiLCJhY2hpZXZlbWVudCIsImhhcyIsInNob3VsZFVubG9jayIsIm5hbWUiLCJsZW5ndGgiLCJmaWx0ZXIiLCJnIiwic3RhdHVzIiwiaW5zZXJ0RXJyb3IiLCJpbnNlcnQiLCJ1c2VyX2lkIiwidW5sb2NrZWRfYXQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJ0aXRsZSIsIm1lc3NhZ2UiLCJkZXNjcmlwdGlvbiIsInR5cGUiLCJyZWFkIiwicmFyaXR5IiwicHVzaCIsIndpbmRvdyIsImRpc3BhdGNoRXZlbnQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImNvbnNvbGUiLCJ0cmlnZ2VyQWNoaWV2ZW1lbnRDaGVjayIsImNsZWFyVGltZW91dCIsImFjaGlldmVtZW50Q2hlY2tUaW1lb3V0Iiwic2V0VGltZW91dCIsImdldFVzZXJBY2hpZXZlbWVudHMiLCJvcmRlciIsImFzY2VuZGluZyIsImdldEFjaGlldmVtZW50UHJvZ3Jlc3MiLCJhY2hpZXZlbWVudElkIiwiYWNoaWV2ZW1lbnRFcnJvciIsInNpbmdsZSIsInByb2dyZXNzIiwidG90YWwiLCJNYXRoIiwibWluIiwidW5sb2NrZWQiLCJwZXJjZW50YWdlIiwicm91bmQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./lib/achievement-tracker-db.ts\n"));

/***/ })

}]);